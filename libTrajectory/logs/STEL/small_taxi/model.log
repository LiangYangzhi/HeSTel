2024-10-19 22:02:04,125 - name: STEL_taxi
2024-10-19 22:02:04,125 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}, 'space_distance': 3333, 'time_interval': 600, 'graph_dim': {'dim1': 8, 'dim2': 10, 'dim3': 2, 'dim4': 6, 'dim5': 10}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'model', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-19 22:02:04,125 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-19 22:02:04,125 - loading train tid...
2024-10-19 22:02:04,127 - loading test tid...
2024-10-19 22:02:04,435 - loading enhance sample...
2024-10-19 22:02:09,804 - data load completed
2024-10-19 22:02:09,805 - Executor...
2024-10-19 22:02:09,805 - device=cuda:0, in_dim=36, out_dim=32
2024-10-19 22:02:09,805 - train...
2024-10-19 22:02:09,808 - add_self_loops=True
2024-10-19 22:02:10,607 - lr=0.001, head=4
2024-10-19 22:02:10,608 - full_loss: dis_loss penalty = 0.1
2024-10-19 22:02:10,608 - Epoch 0/1
2024-10-19 22:02:29,857 - 0.639742374420166 + 0.6623134016990662 + 0.7026638984680176 + 5.355469226837158 + 4.928380012512207 = 55.920738220214844
2024-10-19 22:02:31,466 - 0.3191828727722168 + 0.36498358845710754 + 0.39036187529563904 + 3.3660573959350586 + 3.300985813140869 = 30.179643630981445
2024-10-19 22:02:33,181 - 0.2689240574836731 + 0.32036349177360535 + 0.3307192921638489 + 2.7950949668884277 + 2.524428367614746 = 25.276554107666016
2024-10-19 22:02:34,549 - 0.18470817804336548 + 0.23626849055290222 + 0.2398962676525116 + 2.2514517307281494 + 2.0159714221954346 = 18.264480590820312
2024-10-19 22:02:35,970 - 0.16428914666175842 + 0.21986331045627594 + 0.25039443373680115 + 2.032146453857422 + 1.8145211935043335 = 16.763702392578125
2024-10-19 22:02:37,549 - 0.1972518414258957 + 0.24967214465141296 + 0.25154435634613037 + 2.241379737854004 + 2.0124008655548096 = 19.128538131713867
2024-10-19 22:02:46,574 - 0.1570473313331604 + 0.21920235455036163 + 0.21902251243591309 + 1.9930448532104492 + 1.8484008312225342 = 16.076061248779297
2024-10-19 22:02:47,972 - 0.12637515366077423 + 0.16843894124031067 + 0.17489388585090637 + 1.551234245300293 + 1.3715862035751343 = 12.674905776977539
2024-10-19 22:02:49,323 - 0.119728222489357 + 0.16112862527370453 + 0.18341270089149475 + 1.44487464427948 + 1.299277424812317 = 12.175975799560547
2024-10-19 22:02:50,970 - 0.10499031841754913 + 0.15334567427635193 + 0.17149993777275085 + 1.4122051000595093 + 1.2340985536575317 = 11.144275665283203
2024-10-19 22:02:52,390 - 0.12577953934669495 + 0.1746336966753006 + 0.18893346190452576 + 1.6444898843765259 + 1.4468677043914795 = 13.016007423400879
2024-10-19 22:02:54,044 - 0.10321179032325745 + 0.14223583042621613 + 0.16173623502254486 + 1.4286280870437622 + 1.2977700233459473 = 10.926708221435547
2024-10-19 22:03:02,815 - 0.10934741795063019 + 0.14607636630535126 + 0.16765199601650238 + 1.3122344017028809 + 1.2533401250839233 = 11.170228958129883
2024-10-19 22:03:04,263 - 0.09122927486896515 + 0.13564646244049072 + 0.13370496034622192 + 1.3079960346221924 + 1.16938316822052 = 9.732357025146484
2024-10-19 22:03:05,637 - 0.07978107035160065 + 0.1153709813952446 + 0.12698882818222046 + 1.2042683362960815 + 1.1729624271392822 = 8.78988265991211
2024-10-19 22:03:07,069 - 0.0866088941693306 + 0.11413484811782837 + 0.11801706999540329 + 1.2030216455459595 + 1.188733458518982 = 9.043718338012695
2024-10-19 22:03:08,455 - 0.07957454025745392 + 0.11972778290510178 + 0.13781026005744934 + 1.1849912405014038 + 1.1333527565002441 = 8.872451782226562
2024-10-19 22:03:09,989 - 0.07003316283226013 + 0.11221437156200409 + 0.11849858611822128 + 1.1807832717895508 + 1.1470857858657837 = 8.13665771484375
2024-10-19 22:03:18,281 - 0.06985118985176086 + 0.11512290686368942 + 0.13505640625953674 + 1.2736760377883911 + 1.249969244003296 = 8.517997741699219
2024-10-19 22:03:19,876 - 0.10302866995334625 + 0.15173016488552094 + 0.14691868424415588 + 1.3023601770401 + 1.1806437969207764 = 10.620926856994629
2024-10-19 22:03:21,420 - 0.0767250582575798 + 0.10979168117046356 + 0.13643962144851685 + 1.0592632293701172 + 1.044656753540039 = 8.402485847473145
2024-10-19 22:03:23,288 - 0.07473490387201309 + 0.11295264214277267 + 0.13296553492546082 + 1.2294516563415527 + 1.1893583536148071 = 8.614736557006836
2024-10-19 22:03:24,637 - 0.06892527639865875 + 0.12034879624843597 + 0.12296628206968307 + 1.211275577545166 + 1.1601096391677856 = 8.250800132751465
2024-10-19 22:03:26,276 - 0.07908710837364197 + 0.1003531664609909 + 0.13170620799064636 + 1.040960431098938 + 1.024413824081421 = 8.340323448181152
2024-10-19 22:03:32,785 - 0.060875438153743744 + 0.10116405040025711 + 0.10976265370845795 + 1.0918232202529907 + 0.9819003343582153 = 7.226762294769287
2024-10-19 22:03:34,166 - 0.07418933510780334 + 0.12621451914310455 + 0.1345215141773224 + 1.1662646532058716 + 0.9331196546554565 = 8.416211128234863
2024-10-19 22:03:35,664 - 0.07508409023284912 + 0.10428456217050552 + 0.13236084580421448 + 1.1119384765625 + 1.0436853170394897 = 8.27628231048584
2024-10-19 22:03:37,114 - 0.050749413669109344 + 0.0939289927482605 + 0.09716854989528656 + 1.0320641994476318 + 1.0782345533370972 = 6.558744430541992
2024-10-19 22:03:38,817 - 0.08263037353754044 + 0.11122415959835052 + 0.11389575898647308 + 1.1679644584655762 + 1.0419456958770752 = 8.592628479003906
2024-10-19 22:03:40,497 - 0.08112139999866486 + 0.10759145021438599 + 0.12390676885843277 + 1.0968109369277954 + 1.109618067741394 = 8.57748031616211
2024-10-19 22:03:51,943 - 0.07221026718616486 + 0.11462252587080002 + 0.11532328277826309 + 1.220160961151123 + 1.1840916872024536 = 8.314224243164062
2024-10-19 22:03:53,426 - 0.0731869786977768 + 0.10391084849834442 + 0.11170957237482071 + 1.0152084827423096 + 0.8769961595535278 = 7.707757949829102
2024-10-19 22:03:55,265 - 0.07856911420822144 + 0.11840298771858215 + 0.1181185394525528 + 1.2769359350204468 + 1.1608537435531616 = 8.731460571289062
2024-10-19 22:03:57,146 - 0.06725157052278519 + 0.0930592343211174 + 0.10639019310474396 + 1.0492843389511108 + 0.978947639465332 = 7.385304927825928
2024-10-19 22:03:58,714 - 0.04901040717959404 + 0.08565637469291687 + 0.10016179084777832 + 0.9067449569702148 + 0.8351359367370605 = 6.0505828857421875
2024-10-19 22:04:00,415 - 0.054109837859869 + 0.08760878443717957 + 0.09549759328365326 + 0.8844910264015198 + 0.8673213124275208 = 6.288368225097656
2024-10-19 22:04:07,300 - 0.0703519955277443 + 0.11050111055374146 + 0.12127421051263809 + 1.0823967456817627 + 0.966625452041626 = 7.884374618530273
2024-10-19 22:04:08,941 - 0.060081012547016144 + 0.09882443398237228 + 0.11470393091440201 + 0.9754549264907837 + 0.8650540113449097 = 6.9798431396484375
2024-10-19 22:04:10,321 - 0.07361964881420135 + 0.1041916087269783 + 0.12253998219966888 + 0.974069356918335 + 0.8805994391441345 = 7.802967548370361
2024-10-19 22:04:11,914 - 0.07395195960998535 + 0.11309390515089035 + 0.11128944903612137 + 1.0553932189941406 + 1.0989962816238403 = 8.095821380615234
2024-10-19 22:04:13,476 - 0.04445349797606468 + 0.08376841247081757 + 0.08497952669858932 + 0.9933372735977173 + 0.9781808853149414 = 5.881672382354736
2024-10-19 22:04:15,314 - 0.07272886484861374 + 0.09901013970375061 + 0.10764113068580627 + 1.0323582887649536 + 0.9552221298217773 = 7.690536022186279
2024-10-19 22:04:22,764 - 0.0628516674041748 + 0.09105251729488373 + 0.10323306918144226 + 0.8770022392272949 + 0.8068184852600098 = 6.769260406494141
2024-10-19 22:04:24,341 - 0.06395874917507172 + 0.09689228236675262 + 0.10749886929988861 + 0.9818386435508728 + 0.8325668573379517 = 7.056254863739014
2024-10-19 22:04:26,001 - 0.053724583238363266 + 0.0797506719827652 + 0.08273683488368988 + 0.8968656063079834 + 0.8579933643341064 = 6.065962791442871
2024-10-19 22:04:27,431 - 0.05465070530772209 + 0.08724722266197205 + 0.09997536242008209 + 0.9240512847900391 + 0.8442073464393616 = 6.373019695281982
2024-10-19 22:04:29,079 - 0.06399942934513092 + 0.09320380538702011 + 0.10771253705024719 + 0.9184734225273132 + 0.7971454858779907 = 6.924753665924072
2024-10-19 22:04:30,696 - 0.054666027426719666 + 0.08495436608791351 + 0.08483975380659103 + 1.0767548084259033 + 0.9744639992713928 = 6.482461452484131
2024-10-19 22:04:34,639 - 0.055262308567762375 + 0.09183696657419205 + 0.09239630401134491 + 0.8742908835411072 + 0.7229304313659668 = 6.202669620513916
2024-10-19 22:04:36,052 - 0.057256460189819336 + 0.08499637246131897 + 0.09958900511264801 + 0.8520503640174866 + 0.7642735242843628 = 6.325000762939453
2024-10-19 22:04:41,139 - 0.05052037537097931 + 0.0819321945309639 + 0.08816425502300262 + 0.9557720422744751 + 0.8595609664916992 = 6.04231595993042
2024-10-19 22:04:42,811 - 0.05652950704097748 + 0.08741580694913864 + 0.09752939641475677 + 0.9319283366203308 + 0.8990877866744995 = 6.506943702697754
2024-10-19 22:04:44,159 - 0.07009394466876984 + 0.09441080689430237 + 0.12483838200569153 + 0.9156174659729004 + 0.8307009935379028 = 7.443507671356201
2024-10-19 22:04:45,904 - 0.05865573137998581 + 0.08417725563049316 + 0.08778609335422516 + 0.975784182548523 + 0.9957733750343323 = 6.6239776611328125
2024-10-19 22:04:46,777 - 0.043792907148599625 + 0.08461602032184601 + 0.08670104295015335 + 0.9145717024803162 + 0.9574589133262634 = 5.77484655380249
2024-10-19 22:04:46,789 - epoch loss:10.383493744243275
2024-10-19 22:04:46,789 - full_loss min:[0.043792907148599625, 0.04445349797606468], max:0.639742374420166, mean:0.09927809082648971
2024-10-19 22:04:46,789 - ns1_loss min:[0.08273683488368988, 0.08483975380659103], max:0.7026638984680176, mean:0.14832817261869258
2024-10-19 22:04:46,789 - ns2_loss min:[0.0797506719827652, 0.0819321945309639], max:0.6623134016990662, mean:0.13682662018320776
2024-10-19 22:04:46,789 - ps1_loss min:[0.8520503640174866, 0.8742908835411072], max:5.355469226837158, mean:1.3318920146335256
2024-10-19 22:04:46,789 - ps2_loss min:[0.7229304313659668, 0.7642735242843628], max:4.928380012512207, mean:1.236149228702892
2024-10-19 22:04:46,789 - test
2024-10-19 22:04:46,792 - add_self_loops=True
2024-10-19 22:04:46,798 - net=model
2024-10-19 22:04:46,798 - test1...
2024-10-19 22:04:48,804 - k = 10
2024-10-19 22:04:48,825 - Acc@1=715/1000=0.715
2024-10-19 22:04:48,826 - Acc@2=799/1000=0.799
2024-10-19 22:04:48,827 - Acc@3=842/1000=0.842
2024-10-19 22:04:48,827 - Acc@4=867/1000=0.867
2024-10-19 22:04:48,828 - Acc@5=886/1000=0.886
2024-10-19 22:04:48,828 - Acc@6=906/1000=0.906
2024-10-19 22:04:48,829 - Acc@7=916/1000=0.916
2024-10-19 22:04:48,829 - Acc@8=921/1000=0.921
2024-10-19 22:04:48,830 - Acc@9=925/1000=0.925
2024-10-19 22:04:48,831 - Acc@10=931/1000=0.931
2024-10-19 22:04:48,831 - test2...
2024-10-19 22:04:53,023 - k = 10
2024-10-19 22:04:53,096 - Acc@1=1836/3000=0.612
2024-10-19 22:04:53,097 - Acc@2=2143/3000=0.714333
2024-10-19 22:04:53,098 - Acc@3=2281/3000=0.760333
2024-10-19 22:04:53,098 - Acc@4=2373/3000=0.791
2024-10-19 22:04:53,099 - Acc@5=2429/3000=0.809667
2024-10-19 22:04:53,099 - Acc@6=2483/3000=0.827667
2024-10-19 22:04:53,100 - Acc@7=2510/3000=0.836667
2024-10-19 22:04:53,100 - Acc@8=2540/3000=0.846667
2024-10-19 22:04:53,101 - Acc@9=2570/3000=0.856667
2024-10-19 22:04:53,102 - Acc@10=2589/3000=0.863
