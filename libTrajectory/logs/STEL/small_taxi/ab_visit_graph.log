2024-10-26 15:36:38,807 - name: STEL_taxi_ab_visit_graph
2024-10-26 15:36:38,807 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_visit_graph', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 15:36:38,807 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-26 15:36:38,807 - loading train tid...
2024-10-26 15:36:38,810 - loading test tid...
2024-10-26 15:36:39,255 - loading enhance sample...
2024-10-26 15:36:44,961 - data load completed
2024-10-26 15:36:44,961 - visit_graph
2024-10-26 15:36:44,961 - Executor...
2024-10-26 15:36:44,962 - device=cuda:0, in_dim=36, out_dim=32
2024-10-26 15:36:44,962 - train...
2024-10-26 15:36:44,965 - add_self_loops=True
2024-10-26 15:36:45,819 - lr=0.001, head=4
2024-10-26 15:36:45,819 - full_loss: dis_loss penalty = 0.1
2024-10-26 15:36:45,819 - Epoch 0/1
2024-10-26 15:37:08,581 - 0.7945437431335449 + 0.8016324043273926 + 0.7356889247894287 + 6.432520389556885 + 6.275813102722168 = 67.80873107910156
2024-10-26 15:37:09,973 - 0.47143226861953735 + 0.49043118953704834 + 0.49207377433776855 + 3.998791217803955 + 3.898050308227539 = 41.29350280761719
2024-10-26 15:37:11,432 - 0.40821903944015503 + 0.43739965558052063 + 0.4574888348579407 + 3.5719752311706543 + 3.5117757320404053 = 36.44358825683594
2024-10-26 15:37:12,787 - 0.2558016777038574 + 0.3064608573913574 + 0.3221933841705322 + 2.529794454574585 + 2.5529062747955322 = 24.159326553344727
2024-10-26 15:37:14,407 - 0.2510817050933838 + 0.2809668183326721 + 0.2821817994117737 + 2.280203104019165 + 2.2697930335998535 = 22.735565185546875
2024-10-26 15:37:15,847 - 0.24401423335075378 + 0.2714073657989502 + 0.29821711778640747 + 2.2392494678497314 + 2.2430219650268555 = 22.379230499267578
2024-10-26 15:37:25,279 - 0.2166585922241211 + 0.26098334789276123 + 0.276027649641037 + 2.124598264694214 + 2.2755680084228516 = 20.60320472717285
2024-10-26 15:37:26,958 - 0.20469793677330017 + 0.24595049023628235 + 0.2511012554168701 + 2.0032358169555664 + 1.9905319213867188 = 19.199180603027344
2024-10-26 15:37:28,405 - 0.14742888510227203 + 0.19707410037517548 + 0.20221009850502014 + 1.6350809335708618 + 1.6260578632354736 = 14.625425338745117
2024-10-26 15:37:29,776 - 0.15196049213409424 + 0.20378926396369934 + 0.20355623960494995 + 1.6564602851867676 + 1.639785885810852 = 14.96772575378418
2024-10-26 15:37:31,231 - 0.17707520723342896 + 0.23441214859485626 + 0.2278396487236023 + 1.9074938297271729 + 1.9078369140625 = 17.291608810424805
2024-10-26 15:37:32,616 - 0.17109455168247223 + 0.2048395276069641 + 0.2014271318912506 + 1.6725051403045654 + 1.708885669708252 = 15.998785018920898
2024-10-26 15:37:38,587 - 0.20109719038009644 + 0.24302053451538086 + 0.2518211007118225 + 1.986801266670227 + 1.9361343383789062 = 18.926210403442383
2024-10-26 15:37:40,066 - 0.20113737881183624 + 0.23007529973983765 + 0.2279980331659317 + 1.8747262954711914 + 1.8531287908554077 = 18.36545753479004
2024-10-26 15:37:41,487 - 0.1720978319644928 + 0.20766645669937134 + 0.21773746609687805 + 1.7024846076965332 + 1.7554094791412354 = 16.31682586669922
2024-10-26 15:37:43,062 - 0.18723762035369873 + 0.22296714782714844 + 0.2367088943719864 + 1.7926304340362549 + 1.7906467914581299 = 17.541919708251953
2024-10-26 15:37:44,682 - 0.17214497923851013 + 0.22249825298786163 + 0.23949477076530457 + 1.822150707244873 + 1.8214950561523438 = 16.870824813842773
2024-10-26 15:37:46,191 - 0.18394233286380768 + 0.215191051363945 + 0.22186121344566345 + 1.7487236261367798 + 1.7179310321807861 = 17.0342960357666
2024-10-26 15:37:57,544 - 0.15626396238803864 + 0.20070356130599976 + 0.21056094765663147 + 1.6263325214385986 + 1.6207407712936401 = 15.172917366027832
2024-10-26 15:37:58,930 - 0.09908545762300491 + 0.1438654065132141 + 0.16126848757266998 + 1.1840711832046509 + 1.2029105424880981 = 10.392593383789062
2024-10-26 15:38:00,629 - 0.13152167201042175 + 0.1666063815355301 + 0.173335000872612 + 1.3613815307617188 + 1.3628489971160889 = 12.699728012084961
2024-10-26 15:38:02,170 - 0.12853607535362244 + 0.15148192644119263 + 0.17658714950084686 + 1.209201693534851 + 1.2667572498321533 = 12.183453559875488
2024-10-26 15:38:03,657 - 0.12010002136230469 + 0.1546463668346405 + 0.16609926521778107 + 1.2702852487564087 + 1.2805559635162354 = 11.763298988342285
2024-10-26 15:38:04,960 - 0.12154081463813782 + 0.17760217189788818 + 0.1803966611623764 + 1.4526149034500122 + 1.4372749328613281 = 12.546918869018555
2024-10-26 15:38:13,137 - 0.08903875946998596 + 0.13318534195423126 + 0.13759367167949677 + 1.0935227870941162 + 1.1308038234710693 = 9.384055137634277
2024-10-26 15:38:14,557 - 0.129206120967865 + 0.1632143259048462 + 0.17863869667053223 + 1.335720419883728 + 1.3603150844573975 = 12.574871063232422
2024-10-26 15:38:15,945 - 0.11265906691551208 + 0.1438848376274109 + 0.15276150405406952 + 1.1930761337280273 + 1.1572295427322388 = 10.949722290039062
2024-10-26 15:38:17,426 - 0.1166229099035263 + 0.14519336819648743 + 0.1704007387161255 + 1.2097612619400024 + 1.224948763847351 = 11.421796798706055
2024-10-26 15:38:18,917 - 0.13057532906532288 + 0.1804516315460205 + 0.19818229973316193 + 1.4753260612487793 + 1.476306438446045 = 13.266738891601562
2024-10-26 15:38:20,260 - 0.09858232736587524 + 0.12792135775089264 + 0.1411643922328949 + 1.0396891832351685 + 0.9821008443832397 = 9.641763687133789
2024-10-26 15:38:28,597 - 0.11096248775720596 + 0.14531557261943817 + 0.1629999876022339 + 1.1912873983383179 + 1.1912145614624023 = 11.013781547546387
2024-10-26 15:38:30,180 - 0.10837585479021072 + 0.14065459370613098 + 0.15949636697769165 + 1.1506931781768799 + 1.137994647026062 = 10.708990097045898
2024-10-26 15:38:31,714 - 0.12248475104570389 + 0.1612744778394699 + 0.16711415350437164 + 1.3065314292907715 + 1.2910983562469482 = 12.005753517150879
2024-10-26 15:38:33,163 - 0.10043077170848846 + 0.1369556486606598 + 0.1551605612039566 + 1.1362569332122803 + 1.1188229322433472 = 10.19778060913086
2024-10-26 15:38:34,533 - 0.11211223900318146 + 0.1412045806646347 + 0.15930376946926117 + 1.1475491523742676 + 1.1351711750030518 = 10.893416404724121
2024-10-26 15:38:36,076 - 0.08686122298240662 + 0.12132754176855087 + 0.12581609189510345 + 0.9911652207374573 + 1.0312618017196655 = 8.83692455291748
2024-10-26 15:38:44,463 - 0.08982354402542114 + 0.11759734898805618 + 0.13729643821716309 + 0.9568315744400024 + 0.9738869667053223 = 8.970832824707031
2024-10-26 15:38:45,956 - 0.09778082370758057 + 0.12249673902988434 + 0.1357550323009491 + 0.9946443438529968 + 1.0245370864868164 = 9.490739822387695
2024-10-26 15:38:47,429 - 0.10142898559570312 + 0.12503781914710999 + 0.1362093985080719 + 1.0144449472427368 + 1.0449382066726685 = 9.743304252624512
2024-10-26 15:38:48,843 - 0.10533373057842255 + 0.13325822353363037 + 0.14842580258846283 + 1.1002150774002075 + 1.1538159847259521 = 10.337557792663574
2024-10-26 15:38:50,368 - 0.11068245768547058 + 0.14754873514175415 + 0.1459527611732483 + 1.2132598161697388 + 1.2058939933776855 = 10.88829231262207
2024-10-26 15:38:51,783 - 0.11205262690782547 + 0.13795159757137299 + 0.1451660692691803 + 1.1030910015106201 + 1.0800803899765015 = 10.616979598999023
2024-10-26 15:39:00,693 - 0.0951802209019661 + 0.12584596872329712 + 0.13108375668525696 + 1.0141849517822266 + 1.01691472530365 = 9.359407424926758
2024-10-26 15:39:02,092 - 0.10830960422754288 + 0.13667818903923035 + 0.14504188299179077 + 1.1222569942474365 + 1.0833380222320557 = 10.438275337219238
2024-10-26 15:39:03,683 - 0.09768079221248627 + 0.13361631333827972 + 0.13576830923557281 + 1.0911548137664795 + 1.0927165746688843 = 9.761756896972656
2024-10-26 15:39:05,259 - 0.10138984769582748 + 0.12499605119228363 + 0.13336443901062012 + 1.0407220125198364 + 1.0701305866241455 = 9.763949394226074
2024-10-26 15:39:07,053 - 0.10093943774700165 + 0.13250243663787842 + 0.1374833881855011 + 1.0787217617034912 + 1.0396020412445068 = 9.865154266357422
2024-10-26 15:39:08,585 - 0.08801621198654175 + 0.11613477766513824 + 0.13687175512313843 + 0.9603066444396973 + 0.9508074522018433 = 8.84199047088623
2024-10-26 15:39:16,444 - 0.11147243529558182 + 0.145430326461792 + 0.15294696390628815 + 1.1958914995193481 + 1.1878225803375244 = 10.941108703613281
2024-10-26 15:39:17,931 - 0.09051346033811569 + 0.11932255327701569 + 0.1270037591457367 + 0.9714532494544983 + 0.9758696556091309 = 8.936258316040039
2024-10-26 15:39:19,200 - 0.08598516136407852 + 0.11408624798059464 + 0.13076551258563995 + 0.928339421749115 + 0.8964390754699707 = 8.572554588317871
2024-10-26 15:39:20,680 - 0.09494343400001526 + 0.12692910432815552 + 0.1274801343679428 + 1.038093090057373 + 1.0255627632141113 = 9.35491943359375
2024-10-26 15:39:22,606 - 0.10428166389465332 + 0.12768498063087463 + 0.12673339247703552 + 1.031631588935852 + 1.022881269454956 = 9.812780380249023
2024-10-26 15:39:24,377 - 0.09628325700759888 + 0.13731887936592102 + 0.14419090747833252 + 1.1185904741287231 + 1.1342048645019531 = 9.882055282592773
2024-10-26 15:39:25,109 - 0.08283072710037231 + 0.1100553348660469 + 0.12165433168411255 + 0.8928179144859314 + 0.8370331525802612 = 8.188484191894531
2024-10-26 15:39:25,121 - epoch loss:14.763314819335937
2024-10-26 15:39:25,121 - full_loss min:[0.08283072710037231, 0.08598516136407852], max:0.7945437431335449, mean:0.15566461695866152
2024-10-26 15:39:25,121 - ns1_loss min:[0.12165433168411255, 0.12581609189510345], max:0.7356889247894287, mean:0.19857638397000052
2024-10-26 15:39:25,121 - ns2_loss min:[0.1100553348660469, 0.11408624798059464], max:0.8016324043273926, mean:0.18994084786285054
2024-10-26 15:39:25,121 - ps1_loss min:[0.8928179144859314, 0.928339421749115], max:6.432520389556885, mean:1.5494644089178606
2024-10-26 15:39:25,121 - ps2_loss min:[0.8370331525802612, 0.8964390754699707], max:6.275813102722168, mean:1.5454473452134565
2024-10-26 15:39:25,121 - test
2024-10-26 15:39:25,124 - add_self_loops=True
2024-10-26 15:39:25,130 - net=ab_visit_graph
2024-10-26 15:39:25,131 - test1...
2024-10-26 15:39:27,147 - k = 10
2024-10-26 15:39:27,184 - Acc@1=519/1000=0.519
2024-10-26 15:39:27,185 - Acc@2=647/1000=0.647
2024-10-26 15:39:27,185 - Acc@3=719/1000=0.719
2024-10-26 15:39:27,186 - Acc@4=752/1000=0.752
2024-10-26 15:39:27,186 - Acc@5=782/1000=0.782
2024-10-26 15:39:27,187 - Acc@6=797/1000=0.797
2024-10-26 15:39:27,188 - Acc@7=819/1000=0.819
2024-10-26 15:39:27,188 - Acc@8=839/1000=0.839
2024-10-26 15:39:27,189 - Acc@9=845/1000=0.845
2024-10-26 15:39:27,189 - Acc@10=853/1000=0.853
2024-10-26 15:39:27,190 - test2...
2024-10-26 15:39:31,687 - k = 10
2024-10-26 15:39:31,766 - Acc@1=1164/3000=0.388
2024-10-26 15:39:31,767 - Acc@2=1474/3000=0.491333
2024-10-26 15:39:31,768 - Acc@3=1638/3000=0.546
2024-10-26 15:39:31,768 - Acc@4=1773/3000=0.591
2024-10-26 15:39:31,769 - Acc@5=1888/3000=0.629333
2024-10-26 15:39:31,770 - Acc@6=1964/3000=0.654667
2024-10-26 15:39:31,770 - Acc@7=2039/3000=0.679667
2024-10-26 15:39:31,771 - Acc@8=2089/3000=0.696333
2024-10-26 15:39:31,772 - Acc@9=2153/3000=0.717667
2024-10-26 15:39:31,772 - Acc@10=2184/3000=0.728
