2024-10-26 19:21:55,559 - name: STEL_taxi_ab_cross_loss
2024-10-26 19:21:55,559 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_cross_loss', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 19:21:55,560 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-26 19:21:55,560 - loading train tid...
2024-10-26 19:21:55,561 - loading test tid...
2024-10-26 19:21:55,880 - loading enhance sample...
2024-10-26 19:22:01,812 - data load completed
2024-10-26 19:22:01,813 - cross_loss
2024-10-26 19:22:01,813 - Executor...
2024-10-26 19:22:01,813 - device=cuda:0, in_dim=36, out_dim=32
2024-10-26 19:22:01,813 - train...
2024-10-26 19:22:01,816 - add_self_loops=True
2024-10-26 19:22:02,646 - lr=0.001, head=4
2024-10-26 19:22:02,646 - Epoch 0/1
2024-10-26 19:22:21,286 - 3.459599256515503 + 3.495548963546753 + 3.4989004135131836 + 28.86185646057129 + 28.138671875 = 299.92498779296875
2024-10-26 19:22:22,618 - 3.186462879180908 + 3.2227611541748047 + 3.2285897731781006 + 26.58692169189453 + 26.092557907104492 = 276.5161437988281
2024-10-26 19:22:23,963 - 3.037122964859009 + 3.0807833671569824 + 3.0883467197418213 + 25.42327880859375 + 24.834007263183594 = 263.80474853515625
2024-10-26 19:22:25,314 - 2.892989158630371 + 2.929042100906372 + 2.941568613052368 + 24.17233657836914 + 23.594690322875977 = 251.12258911132812
2024-10-26 19:22:26,633 - 2.7562179565429688 + 2.8101556301116943 + 2.8182406425476074 + 23.485130310058594 + 22.675434112548828 = 240.2554168701172
2024-10-26 19:22:28,135 - 2.7155518531799316 + 2.781792640686035 + 2.805436849594116 + 23.19968605041504 + 21.81502914428711 = 236.66461181640625
2024-10-26 19:22:35,322 - 2.550523519515991 + 2.6134848594665527 + 2.6482694149017334 + 22.382356643676758 + 21.59211540222168 = 224.11819458007812
2024-10-26 19:22:36,882 - 2.4718000888824463 + 2.5569345951080322 + 2.56093430519104 + 21.924057006835938 + 20.53864288330078 = 217.23138427734375
2024-10-26 19:22:38,388 - 2.2317299842834473 + 2.3209540843963623 + 2.3587849140167236 + 19.641271591186523 + 18.61448097229004 = 196.6396484375
2024-10-26 19:22:39,790 - 2.13930606842041 + 2.2405383586883545 + 2.2953128814697266 + 18.867422103881836 + 18.102527618408203 = 189.2937469482422
2024-10-26 19:22:41,254 - 2.017916202545166 + 2.14062237739563 + 2.1472625732421875 + 18.721389770507812 + 18.022485733032227 = 180.51853942871094
2024-10-26 19:22:42,725 - 1.9635202884674072 + 2.096360683441162 + 2.101270914077759 + 18.6166934967041 + 18.16883659362793 = 176.9378662109375
2024-10-26 19:22:51,122 - 2.0426180362701416 + 2.194070816040039 + 2.1435611248016357 + 18.8076229095459 + 17.6956787109375 = 182.01051330566406
2024-10-26 19:22:52,877 - 1.9820365905761719 + 2.1212971210479736 + 2.1383326053619385 + 18.128673553466797 + 16.650728225708008 = 176.4775390625
2024-10-26 19:22:54,667 - 1.8255040645599365 + 1.9554201364517212 + 2.0007879734039307 + 17.50347328186035 + 16.733251571655273 = 165.07400512695312
2024-10-26 19:22:55,968 - 1.562841534614563 + 1.7158268690109253 + 1.7292680740356445 + 15.496307373046875 + 14.489997863769531 = 142.57931518554688
2024-10-26 19:22:57,821 - 1.500928282737732 + 1.66472327709198 + 1.6651012897491455 + 15.808273315429688 + 14.714436531066895 = 138.86737060546875
2024-10-26 19:22:59,673 - 1.5159450769424438 + 1.6915202140808105 + 1.725466012954712 + 15.800760269165039 + 14.756028175354004 = 140.52391052246094
2024-10-26 19:23:05,624 - 1.3833104372024536 + 1.5179529190063477 + 1.5800514221191406 + 13.71379566192627 + 12.89836311340332 = 126.75772094726562
2024-10-26 19:23:07,115 - 1.2658894062042236 + 1.4527753591537476 + 1.4647538661956787 + 13.37513542175293 + 12.43520736694336 = 118.28010559082031
2024-10-26 19:23:10,522 - 1.5084567070007324 + 1.6755918264389038 + 1.7644389867782593 + 15.401605606079102 + 13.73330307006836 = 138.9580535888672
2024-10-26 19:23:11,797 - 1.229583978652954 + 1.4210008382797241 + 1.437886118888855 + 12.462774276733398 + 11.105892181396484 = 113.63673400878906
2024-10-26 19:23:13,301 - 1.241185188293457 + 1.4478154182434082 + 1.5061393976211548 + 13.150317192077637 + 12.631871223449707 = 117.38099670410156
2024-10-26 19:23:14,814 - 1.2369221448898315 + 1.4447717666625977 + 1.495027780532837 + 12.718819618225098 + 11.440300941467285 = 115.4032211303711
2024-10-26 19:23:23,586 - 1.5075310468673706 + 1.7000401020050049 + 1.8095840215682983 + 15.455900192260742 + 13.639666557312012 = 139.568359375
2024-10-26 19:23:25,214 - 0.9494525194168091 + 1.1598187685012817 + 1.1965769529342651 + 11.048964500427246 + 10.225752830505371 = 92.3113021850586
2024-10-26 19:23:26,715 - 1.0173263549804688 + 1.2408688068389893 + 1.2175732851028442 + 12.15683364868164 + 10.998050689697266 = 98.60562133789062
2024-10-26 19:23:28,328 - 1.0663834810256958 + 1.2893109321594238 + 1.3349894285202026 + 12.838542938232422 + 11.60817813873291 = 104.00890350341797
2024-10-26 19:23:30,114 - 0.8584001064300537 + 1.112166404724121 + 1.122990608215332 + 11.515380859375 + 10.794132232666016 = 87.58108520507812
2024-10-26 19:23:31,449 - 0.9955148100852966 + 1.203354835510254 + 1.2358877658843994 + 11.743268966674805 + 10.172595977783203 = 96.08403015136719
2024-10-26 19:23:40,034 - 1.1341725587844849 + 1.3435440063476562 + 1.445741057395935 + 12.55760383605957 + 11.417064666748047 = 108.57615661621094
2024-10-26 19:23:41,619 - 0.9187918305397034 + 1.1124800443649292 + 1.200386643409729 + 10.759886741638184 + 9.703561782836914 = 89.53170776367188
2024-10-26 19:23:43,076 - 1.1352773904800415 + 1.407322883605957 + 1.4699991941452026 + 12.53916072845459 + 11.886244773864746 = 109.96249389648438
2024-10-26 19:23:44,664 - 0.9231805801391602 + 1.2042075395584106 + 1.1785868406295776 + 12.521688461303711 + 11.550583839416504 = 94.05924224853516
2024-10-26 19:23:46,150 - 0.9138283729553223 + 1.211527705192566 + 1.1020387411117554 + 12.124226570129395 + 10.670310020446777 = 91.62162017822266
2024-10-26 19:23:47,915 - 0.8572348952293396 + 1.114098310470581 + 1.0857657194137573 + 10.922721862792969 + 9.991758346557617 = 85.77486419677734
2024-10-26 19:23:54,887 - 0.7238969802856445 + 0.9395625591278076 + 1.0314385890960693 + 10.090964317321777 + 9.678110122680664 = 75.67393493652344
2024-10-26 19:23:56,445 - 0.6411065459251404 + 0.8682582974433899 + 0.9906387329101562 + 9.28976821899414 + 8.817400932312012 = 68.75146484375
2024-10-26 19:23:58,147 - 0.9125059247016907 + 1.2017992734909058 + 1.2762398719787598 + 11.902229309082031 + 10.439661026000977 = 92.7475814819336
2024-10-26 19:23:59,715 - 0.8292745351791382 + 1.088610291481018 + 1.1126071214675903 + 10.859794616699219 + 10.433226585388184 = 84.7689208984375
2024-10-26 19:24:01,114 - 0.7869024872779846 + 1.0139364004135132 + 1.071398138999939 + 9.752172470092773 + 9.001680374145508 = 78.95232391357422
2024-10-26 19:24:02,557 - 0.6558576226234436 + 0.8895670771598816 + 0.9115802049636841 + 9.566849708557129 + 9.437413215637207 = 69.8086166381836
2024-10-26 19:24:08,173 - 0.634702205657959 + 0.8663852214813232 + 0.9129579067230225 + 9.884098052978516 + 8.885497093200684 = 68.29813385009766
2024-10-26 19:24:10,276 - 0.9179286956787109 + 1.203299880027771 + 1.242201566696167 + 10.961503982543945 + 10.037092208862305 = 91.35005187988281
2024-10-26 19:24:11,814 - 0.6822212934494019 + 0.9365432262420654 + 0.9883840084075928 + 9.236360549926758 + 8.588139533996582 = 71.1848373413086
2024-10-26 19:24:13,200 - 0.694402813911438 + 0.9709869027137756 + 1.006493091583252 + 9.924274444580078 + 9.384892463684082 = 73.80411529541016
2024-10-26 19:24:14,661 - 0.735390841960907 + 1.0215362310409546 + 1.0596837997436523 + 11.135198593139648 + 8.622496604919434 = 77.33943939208984
2024-10-26 19:24:16,115 - 0.7083200216293335 + 0.9533966779708862 + 1.031434178352356 + 9.600502014160156 + 8.27440357208252 = 73.13921356201172
2024-10-26 19:24:24,614 - 0.6954008936882019 + 0.8893437385559082 + 1.0181365013122559 + 10.745316505432129 + 9.394211769104004 = 73.984375
2024-10-26 19:24:26,241 - 0.6505793333053589 + 0.8649085760116577 + 1.0643508434295654 + 9.551412582397461 + 8.908303260803223 = 70.2812728881836
2024-10-26 19:24:27,516 - 0.4442436397075653 + 0.7179259657859802 + 0.7197548747062683 + 7.405303478240967 + 6.503854751586914 = 50.498146057128906
2024-10-26 19:24:29,110 - 0.5827919840812683 + 0.7981963157653809 + 0.8709216117858887 + 9.323258399963379 + 9.130980491638184 = 64.28501892089844
2024-10-26 19:24:30,779 - 0.5810465812683105 + 0.8584399223327637 + 0.8423791527748108 + 10.823756217956543 + 10.752098083496094 = 67.63638305664062
2024-10-26 19:24:32,278 - 0.6692557334899902 + 0.937813401222229 + 0.9757697582244873 + 10.045666694641113 + 9.810407638549805 = 72.4546890258789
2024-10-26 19:24:33,123 - 0.5201467871665955 + 0.8382304906845093 + 0.7595210671424866 + 9.288344383239746 + 9.382474899291992 = 60.655677795410156
2024-10-26 19:24:33,135 - epoch loss:127.49594449129971
2024-10-26 19:24:33,135 - full_loss min:[0.4442436397075653, 0.5201467871665955], max:3.459599256515503, mean:1.3647460097616368
2024-10-26 19:24:33,135 - ns1_loss min:[0.7197548747062683, 0.7595210671424866], max:3.4989004135131836, mean:1.5896317081017928
2024-10-26 19:24:33,136 - ns2_loss min:[0.7179259657859802, 0.7981963157653809], max:3.495548963546753, mean:1.5554404757239602
2024-10-26 19:24:33,136 - ps1_loss min:[7.405303478240967, 9.236360549926758], max:28.86185646057129, mean:14.360380233417859
2024-10-26 19:24:33,136 - ps2_loss min:[6.503854751586914, 8.27440357208252], max:28.138671875, mean:13.44754151430997
2024-10-26 19:24:33,136 - test
2024-10-26 19:24:33,138 - add_self_loops=True
2024-10-26 19:24:33,144 - net=ab_cross_loss
2024-10-26 19:24:33,145 - test1...
2024-10-26 19:24:35,200 - k = 10
2024-10-26 19:24:35,221 - Acc@1=624/1000=0.624
2024-10-26 19:24:35,222 - Acc@2=741/1000=0.741
2024-10-26 19:24:35,223 - Acc@3=796/1000=0.796
2024-10-26 19:24:35,223 - Acc@4=832/1000=0.832
2024-10-26 19:24:35,224 - Acc@5=855/1000=0.855
2024-10-26 19:24:35,224 - Acc@6=863/1000=0.863
2024-10-26 19:24:35,225 - Acc@7=874/1000=0.874
2024-10-26 19:24:35,225 - Acc@8=884/1000=0.884
2024-10-26 19:24:35,226 - Acc@9=893/1000=0.893
2024-10-26 19:24:35,226 - Acc@10=905/1000=0.905
2024-10-26 19:24:35,227 - test2...
2024-10-26 19:24:39,133 - k = 10
2024-10-26 19:24:39,223 - Acc@1=1492/3000=0.497333
2024-10-26 19:24:39,224 - Acc@2=1850/3000=0.616667
2024-10-26 19:24:39,225 - Acc@3=2052/3000=0.684
2024-10-26 19:24:39,226 - Acc@4=2178/3000=0.726
2024-10-26 19:24:39,226 - Acc@5=2252/3000=0.750667
2024-10-26 19:24:39,227 - Acc@6=2308/3000=0.769333
2024-10-26 19:24:39,228 - Acc@7=2360/3000=0.786667
2024-10-26 19:24:39,228 - Acc@8=2402/3000=0.800667
2024-10-26 19:24:39,229 - Acc@9=2434/3000=0.811333
2024-10-26 19:24:39,230 - Acc@10=2478/3000=0.826
