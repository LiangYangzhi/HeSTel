2024-10-26 18:06:48,538 - name: STEL_taxi_ab_trajectory_graph
2024-10-26 18:06:48,539 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_trajectory_graph', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 18:06:48,539 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-26 18:06:48,539 - loading train tid...
2024-10-26 18:06:48,540 - loading test tid...
2024-10-26 18:06:48,881 - loading enhance sample...
2024-10-26 18:06:54,606 - data load completed
2024-10-26 18:06:54,606 - trajectory_graph
2024-10-26 18:06:54,606 - Executor...
2024-10-26 18:06:54,607 - device=cuda:0, in_dim=36, out_dim=32
2024-10-26 18:06:54,607 - train...
2024-10-26 18:06:54,610 - add_self_loops=True
2024-10-26 18:06:55,462 - lr=0.001, head=4
2024-10-26 18:06:55,462 - full_loss: dis_loss penalty = 0.1
2024-10-26 18:06:55,463 - Epoch 0/1
2024-10-26 18:07:15,930 - 0.3429756164550781 + 0.37180250883102417 + 0.38725370168685913 + 3.0068118572235107 + 2.9066221714019775 = 30.65277671813965
2024-10-26 18:07:17,358 - 0.21844369173049927 + 0.2750430107116699 + 0.28904658555984497 + 2.257190465927124 + 2.237309455871582 = 21.057579040527344
2024-10-26 18:07:18,714 - 0.2740626335144043 + 0.29253119230270386 + 0.2715757489204407 + 2.3593103885650635 + 2.396273374557495 = 24.09978485107422
2024-10-26 18:07:20,327 - 0.22795216739177704 + 0.25983941555023193 + 0.27991002798080444 + 2.1060636043548584 + 2.0963075160980225 = 20.997474670410156
2024-10-26 18:07:21,767 - 0.21476313471794128 + 0.24433451890945435 + 0.24771937727928162 + 1.9790141582489014 + 1.9552996158599854 = 19.593008041381836
2024-10-26 18:07:23,251 - 0.23019826412200928 + 0.2625739574432373 + 0.26529937982559204 + 2.152064323425293 + 2.2090585231781006 = 21.149770736694336
2024-10-26 18:07:31,774 - 0.1917184591293335 + 0.2295568585395813 + 0.2444063425064087 + 1.8810110092163086 + 1.8502275943756104 = 18.056793212890625
2024-10-26 18:07:33,539 - 0.20172680914402008 + 0.23812665045261383 + 0.24353793263435364 + 1.9431604146957397 + 1.9583935737609863 = 18.804540634155273
2024-10-26 18:07:34,888 - 0.16985338926315308 + 0.21249496936798096 + 0.24029672145843506 + 1.7344779968261719 + 1.7268754243850708 = 16.4819393157959
2024-10-26 18:07:36,339 - 0.19025874137878418 + 0.22274017333984375 + 0.23145604133605957 + 1.7933614253997803 + 1.8279178142547607 = 17.676177978515625
2024-10-26 18:07:38,134 - 0.1531156599521637 + 0.19312909245491028 + 0.21820375323295593 + 1.5694429874420166 + 1.5747028589248657 = 14.913257598876953
2024-10-26 18:07:39,614 - 0.15893112123012543 + 0.19332152605056763 + 0.18683750927448273 + 1.5935239791870117 + 1.6032485961914062 = 14.944918632507324
2024-10-26 18:07:46,366 - 0.13220474123954773 + 0.16319331526756287 + 0.1878894567489624 + 1.3324085474014282 + 1.3221850395202637 = 12.775659561157227
2024-10-26 18:07:48,821 - 0.1450878381729126 + 0.18649786710739136 + 0.2006922960281372 + 1.5334837436676025 + 1.5501976013183594 = 14.20997428894043
2024-10-26 18:07:50,565 - 0.15079154074192047 + 0.1701744794845581 + 0.1861003339290619 + 1.3950456380844116 + 1.42411208152771 = 13.921483039855957
2024-10-26 18:07:52,186 - 0.15709364414215088 + 0.1911274492740631 + 0.20677107572555542 + 1.5658119916915894 + 1.5466209650039673 = 14.946101188659668
2024-10-26 18:07:53,898 - 0.1466260552406311 + 0.19631120562553406 + 0.20389138162136078 + 1.5966131687164307 + 1.5700175762176514 = 14.499958992004395
2024-10-26 18:07:55,414 - 0.12323653697967529 + 0.1656591296195984 + 0.1772911250591278 + 1.355180025100708 + 1.323973536491394 = 12.270483016967773
2024-10-26 18:08:02,058 - 0.11295303702354431 + 0.148514986038208 + 0.15603621304035187 + 1.2120453119277954 + 1.1884727478027344 = 11.093682289123535
2024-10-26 18:08:07,115 - 0.13069555163383484 + 0.1781349927186966 + 0.18282783031463623 + 1.4400913715362549 + 1.4366891384124756 = 13.021186828613281
2024-10-26 18:08:08,618 - 0.12827332317829132 + 0.1519818753004074 + 0.16607806086540222 + 1.2252994775772095 + 1.2436281442642212 = 12.063194274902344
2024-10-26 18:08:10,277 - 0.13522806763648987 + 0.16329360008239746 + 0.1707390397787094 + 1.3338743448257446 + 1.3300678730010986 = 12.76567268371582
2024-10-26 18:08:11,877 - 0.12871627509593964 + 0.15090946853160858 + 0.16593143343925476 + 1.2371244430541992 + 1.2502756118774414 = 12.091623306274414
2024-10-26 18:08:13,636 - 0.1254105269908905 + 0.14952737092971802 + 0.1596614271402359 + 1.2043019533157349 + 1.2483352422714233 = 11.815051078796387
2024-10-26 18:08:19,825 - 0.11484810709953308 + 0.14330968260765076 + 0.1599869430065155 + 1.2117074728012085 + 1.1622414588928223 = 11.149320602416992
2024-10-26 18:08:23,214 - 0.1040635034441948 + 0.1419541835784912 + 0.14419913291931152 + 1.1489874124526978 + 1.1026331186294556 = 10.316329956054688
2024-10-26 18:08:24,865 - 0.10258811712265015 + 0.12969544529914856 + 0.14583849906921387 + 1.051736831665039 + 1.0559697151184082 = 9.992450714111328
2024-10-26 18:08:26,262 - 0.10062365978956223 + 0.12847086787223816 + 0.14399856328964233 + 1.053155779838562 + 1.0206573009490967 = 9.829689979553223
2024-10-26 18:08:27,774 - 0.1136811375617981 + 0.1418578177690506 + 0.1641305685043335 + 1.148436427116394 + 1.1824994087219238 = 11.07487678527832
2024-10-26 18:08:29,168 - 0.09713712334632874 + 0.12219978868961334 + 0.1254299283027649 + 0.9961528778076172 + 0.966959536075592 = 9.296265602111816
2024-10-26 18:08:39,772 - 0.10011095553636551 + 0.13064539432525635 + 0.14280153810977936 + 1.061008334159851 + 1.0409413576126099 = 9.84196662902832
2024-10-26 18:08:41,414 - 0.09841738641262054 + 0.13402369618415833 + 0.13422086834907532 + 1.103203535079956 + 1.0800617933273315 = 9.786581039428711
2024-10-26 18:08:43,089 - 0.09987828135490417 + 0.12737210094928741 + 0.14636072516441345 + 1.0422461032867432 + 1.0526506900787354 = 9.826139450073242
2024-10-26 18:08:44,970 - 0.11443881690502167 + 0.14636580646038055 + 0.15372848510742188 + 1.1858534812927246 + 1.180116891860962 = 11.08885383605957
2024-10-26 18:08:46,561 - 0.10925403982400894 + 0.14348065853118896 + 0.15654407441616058 + 1.1680853366851807 + 1.1673648357391357 = 10.798399925231934
2024-10-26 18:08:48,189 - 0.09888926148414612 + 0.13257601857185364 + 0.14251726865768433 + 1.0830817222595215 + 1.0592552423477173 = 9.83773422241211
2024-10-26 18:08:56,722 - 0.10396306216716766 + 0.13084307312965393 + 0.13832470774650574 + 1.0620524883270264 + 1.0493775606155396 = 10.001260757446289
2024-10-26 18:08:58,167 - 0.10205712914466858 + 0.1331605315208435 + 0.13975217938423157 + 1.0975621938705444 + 1.0832440853118896 = 10.012789726257324
2024-10-26 18:08:59,838 - 0.09574751555919647 + 0.11951388418674469 + 0.1307886242866516 + 0.971034586429596 + 0.962119996547699 = 9.223555564880371
2024-10-26 18:09:01,422 - 0.07947605848312378 + 0.11167934536933899 + 0.11846236139535904 + 0.9174723029136658 + 0.9549605846405029 = 8.147652626037598
2024-10-26 18:09:02,732 - 0.08745068311691284 + 0.11956793069839478 + 0.12477035820484161 + 0.9741109609603882 + 0.996256411075592 = 8.786284446716309
2024-10-26 18:09:03,918 - 0.07706226408481598 + 0.1119738519191742 + 0.11873294413089752 + 0.9100821018218994 + 0.9044945240020752 = 7.974757194519043
2024-10-26 18:09:10,961 - 0.07630928605794907 + 0.09284904599189758 + 0.10135681927204132 + 0.7688946723937988 + 0.769996166229248 = 7.296413421630859
2024-10-26 18:09:14,157 - 0.0918167233467102 + 0.11427296698093414 + 0.12177542597055435 + 0.9311934113502502 + 0.9358773231506348 = 8.818390846252441
2024-10-26 18:09:15,620 - 0.07970233261585236 + 0.10918354243040085 + 0.10473829507827759 + 0.8781214952468872 + 0.9161387085914612 = 7.918594837188721
2024-10-26 18:09:17,265 - 0.10437122732400894 + 0.13176229596138 + 0.13816994428634644 + 1.0757625102996826 + 1.0470200777053833 = 10.040666580200195
2024-10-26 18:09:18,425 - 0.07087726891040802 + 0.09203533083200455 + 0.10391877591609955 + 0.7585561275482178 + 0.722137451171875 = 6.984098434448242
2024-10-26 18:09:19,778 - 0.08282176405191422 + 0.1029745489358902 + 0.11268147826194763 + 0.8318015336990356 + 0.8382564783096313 = 7.967706203460693
2024-10-26 18:09:24,642 - 0.08473742008209229 + 0.11641153693199158 + 0.1174541562795639 + 0.9427284598350525 + 0.9110327959060669 = 8.429288864135742
2024-10-26 18:09:28,177 - 0.08108077198266983 + 0.10304340720176697 + 0.11128302663564682 + 0.8385834693908691 + 0.7960514426231384 = 7.831937789916992
2024-10-26 18:09:29,619 - 0.08836673200130463 + 0.10706661641597748 + 0.11556761711835861 + 0.879286527633667 + 0.829360842704773 = 8.353326797485352
2024-10-26 18:09:31,165 - 0.09309735894203186 + 0.1106657087802887 + 0.11976303905248642 + 0.9144500494003296 + 0.8951083421707153 = 8.76871395111084
2024-10-26 18:09:32,458 - 0.07752138376235962 + 0.0998954325914383 + 0.10427236557006836 + 0.8074483275413513 + 0.8089230060577393 = 7.53411865234375
2024-10-26 18:09:33,928 - 0.07287255674600601 + 0.09885815531015396 + 0.10198987275362015 + 0.8065134286880493 + 0.8081334829330444 = 7.266755104064941
2024-10-26 18:09:34,679 - 0.07082828879356384 + 0.10218384116888046 + 0.10520562529563904 + 0.8296942114830017 + 0.79593825340271 = 7.240942001342773
2024-10-26 18:09:34,693 - epoch loss:12.278871900385075
2024-10-26 18:09:34,693 - full_loss min:[0.07082828879356384, 0.07087726891040802], max:0.3429756164550781, mean:0.1284437644210729
2024-10-26 18:09:34,693 - ns1_loss min:[0.10135681927204132, 0.10198987275362015], max:0.38725370168685913, mean:0.1683312183076685
2024-10-26 18:09:34,693 - ns2_loss min:[0.09203533083200455, 0.09284904599189758], max:0.37180250883102417, mean:0.15892203856598247
2024-10-26 18:09:34,693 - ps1_loss min:[0.7585561275482178, 0.7688946723937988], max:3.0068118572235107, mean:1.2955584872852672
2024-10-26 18:09:34,694 - ps2_loss min:[0.722137451171875, 0.769996166229248], max:2.9066221714019775, mean:1.2885925628922201
2024-10-26 18:09:34,694 - test
2024-10-26 18:09:34,697 - add_self_loops=True
2024-10-26 18:09:34,705 - net=ab_trajectory_graph
2024-10-26 18:09:34,706 - test1...
2024-10-26 18:09:36,877 - k = 10
2024-10-26 18:09:36,899 - Acc@1=513/1000=0.513
2024-10-26 18:09:36,899 - Acc@2=638/1000=0.638
2024-10-26 18:09:36,900 - Acc@3=703/1000=0.703
2024-10-26 18:09:36,901 - Acc@4=738/1000=0.738
2024-10-26 18:09:36,901 - Acc@5=765/1000=0.765
2024-10-26 18:09:36,902 - Acc@6=788/1000=0.788
2024-10-26 18:09:36,902 - Acc@7=807/1000=0.807
2024-10-26 18:09:36,903 - Acc@8=819/1000=0.819
2024-10-26 18:09:36,903 - Acc@9=831/1000=0.831
2024-10-26 18:09:36,904 - Acc@10=847/1000=0.847
2024-10-26 18:09:36,904 - test2...
2024-10-26 18:09:41,359 - k = 10
2024-10-26 18:09:41,465 - Acc@1=1152/3000=0.384
2024-10-26 18:09:41,465 - Acc@2=1453/3000=0.484333
2024-10-26 18:09:41,466 - Acc@3=1624/3000=0.541333
2024-10-26 18:09:41,467 - Acc@4=1756/3000=0.585333
2024-10-26 18:09:41,467 - Acc@5=1864/3000=0.621333
2024-10-26 18:09:41,468 - Acc@6=1934/3000=0.644667
2024-10-26 18:09:41,469 - Acc@7=1994/3000=0.664667
2024-10-26 18:09:41,469 - Acc@8=2054/3000=0.684667
2024-10-26 18:09:41,470 - Acc@9=2108/3000=0.702667
2024-10-26 18:09:41,470 - Acc@10=2156/3000=0.718667
