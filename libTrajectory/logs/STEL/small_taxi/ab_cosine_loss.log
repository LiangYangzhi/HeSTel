2024-10-26 19:26:07,810 - name: STEL_taxi_ab_cosine_loss
2024-10-26 19:26:07,810 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_cosine_loss', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 19:26:07,810 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-26 19:26:07,811 - loading train tid...
2024-10-26 19:26:07,812 - loading test tid...
2024-10-26 19:26:08,137 - loading enhance sample...
2024-10-26 19:26:13,710 - data load completed
2024-10-26 19:26:13,711 - cosine_loss
2024-10-26 19:26:13,711 - Executor...
2024-10-26 19:26:13,711 - device=cuda:0, in_dim=36, out_dim=32
2024-10-26 19:26:13,711 - train...
2024-10-26 19:26:13,714 - add_self_loops=True
2024-10-26 19:26:14,567 - lr=0.001, head=4
2024-10-26 19:26:14,567 - Epoch 0/1
2024-10-26 19:26:35,349 - 94.61028289794922 + 95.05110168457031 + 95.1571044921875 + 765.7900390625 + 765.0899047851562 = 8163.4765625
2024-10-26 19:26:39,037 - 82.10098266601562 + 82.78204345703125 + 82.78443145751953 + 667.8191528320312 + 669.1820068359375 = 7097.71533203125
2024-10-26 19:26:42,753 - 71.17191314697266 + 71.90227508544922 + 72.12397766113281 + 581.1702270507812 + 574.1653442382812 = 6154.1943359375
2024-10-26 19:26:46,363 - 56.5686149597168 + 57.46799850463867 + 57.58856201171875 + 466.68017578125 + 463.6827697753906 = 4909.35888671875
2024-10-26 19:26:49,577 - 40.7248420715332 + 41.767547607421875 + 41.92931365966797 + 338.696044921875 + 340.3139953613281 = 3552.220703125
2024-10-26 19:26:53,293 - 34.32423400878906 + 35.53600311279297 + 35.72637939453125 + 286.5884704589844 + 283.3499755859375 = 2998.77392578125
2024-10-26 19:26:57,285 - 26.010282516479492 + 27.36444664001465 + 27.438432693481445 + 221.75729370117188 + 218.21466064453125 = 2288.514892578125
2024-10-26 19:27:01,067 - 20.44905662536621 + 21.870019912719727 + 22.08478355407715 + 177.65989685058594 + 176.08294677734375 = 1815.743896484375
2024-10-26 19:27:05,287 - 19.32291603088379 + 20.45754623413086 + 20.678983688354492 + 167.37332153320312 + 167.3206329345703 = 1712.205078125
2024-10-26 19:27:08,395 - 18.574636459350586 + 19.82510757446289 + 20.18853759765625 + 161.48558044433594 + 161.94427490234375 = 1652.298095703125
2024-10-26 19:27:11,546 - 18.48391342163086 + 19.70790672302246 + 20.03008270263672 + 160.12168884277344 + 159.15660095214844 = 1640.8538818359375
2024-10-26 19:27:15,344 - 18.730375289916992 + 20.04755973815918 + 20.231996536254883 + 163.3057861328125 + 162.9322509765625 = 1665.5523681640625
2024-10-26 19:27:19,379 - 19.235919952392578 + 20.7321834564209 + 20.739578247070312 + 168.2843017578125 + 166.60293579101562 = 1711.40087890625
2024-10-26 19:27:22,634 - 18.53183364868164 + 19.71340560913086 + 20.004924774169922 + 160.44815063476562 + 161.41424560546875 = 1645.63720703125
2024-10-26 19:27:25,971 - 19.55087661743164 + 20.771812438964844 + 21.132736206054688 + 168.5679931640625 + 169.9501190185547 = 1735.107421875
2024-10-26 19:27:29,164 - 19.3150634765625 + 20.617830276489258 + 20.917715072631836 + 167.58749389648438 + 168.84274291992188 = 1717.5389404296875
2024-10-26 19:27:32,451 - 18.718427658081055 + 20.040889739990234 + 20.4417724609375 + 162.12294006347656 + 162.47669982910156 = 1665.34765625
2024-10-26 19:27:36,074 - 18.74190902709961 + 19.959196090698242 + 20.24913215637207 + 161.70899963378906 + 162.40093994140625 = 1663.28857421875
2024-10-26 19:27:39,299 - 18.097837448120117 + 19.34535026550293 + 19.57071304321289 + 156.0803680419922 + 157.1005401611328 = 1607.2333984375
2024-10-26 19:27:42,468 - 17.580411911010742 + 18.953466415405273 + 19.009845733642578 + 152.87501525878906 + 153.58934020996094 = 1565.117919921875
2024-10-26 19:27:45,802 - 16.886085510253906 + 18.35185432434082 + 18.434499740600586 + 148.23159790039062 + 148.34561157226562 = 1508.744873046875
2024-10-26 19:27:49,242 - 16.07131004333496 + 17.38779640197754 + 17.50287628173828 + 140.4396209716797 + 139.89785766601562 = 1432.8096923828125
2024-10-26 19:27:52,651 - 16.017868041992188 + 17.2523193359375 + 17.51327896118164 + 139.49771118164062 + 139.5442657470703 = 1427.5914306640625
2024-10-26 19:27:55,930 - 16.936351776123047 + 18.351152420043945 + 18.483938217163086 + 147.20509338378906 + 145.33041381835938 = 1507.7039794921875
2024-10-26 19:27:59,516 - 15.752403259277344 + 17.040952682495117 + 17.259336471557617 + 136.4652557373047 + 134.53036499023438 = 1401.61865234375
2024-10-26 19:28:03,137 - 15.016683578491211 + 16.358427047729492 + 16.509109497070312 + 132.01602172851562 + 132.2595977783203 = 1343.78515625
2024-10-26 19:28:06,713 - 14.707785606384277 + 15.950064659118652 + 16.26121711730957 + 129.38818359375 + 130.69790649414062 = 1317.588134765625
2024-10-26 19:28:10,510 - 14.780004501342773 + 15.99760913848877 + 16.2236385345459 + 128.99794006347656 + 129.47930908203125 = 1319.68994140625
2024-10-26 19:28:13,761 - 14.831390380859375 + 16.133012771606445 + 16.3054141998291 + 129.72760009765625 + 129.60089111328125 = 1325.2822265625
2024-10-26 19:28:17,249 - 14.096415519714355 + 15.336103439331055 + 15.683404922485352 + 122.91043090820312 + 122.04144287109375 = 1259.9677734375
2024-10-26 19:28:20,526 - 14.269353866577148 + 15.590763092041016 + 15.795637130737305 + 125.9572982788086 + 125.74620056152344 = 1279.0352783203125
2024-10-26 19:28:23,750 - 14.42939281463623 + 15.753707885742188 + 15.913958549499512 + 126.00641632080078 + 125.21089935302734 = 1289.3636474609375
2024-10-26 19:28:27,076 - 14.068257331848145 + 15.34562873840332 + 15.592897415161133 + 122.52088165283203 + 121.86676788330078 = 1257.185791015625
2024-10-26 19:28:30,314 - 14.913840293884277 + 16.147151947021484 + 16.380769729614258 + 129.93907165527344 + 130.97027587890625 = 1331.880615234375
2024-10-26 19:28:33,350 - 13.811288833618164 + 15.034347534179688 + 15.40335464477539 + 121.89454650878906 + 122.73139953613281 = 1239.5675048828125
2024-10-26 19:28:36,485 - 13.68164348602295 + 15.10870361328125 + 15.327849388122559 + 122.42167663574219 + 123.11355590820312 = 1233.98291015625
2024-10-26 19:28:40,138 - 14.107468605041504 + 15.502634048461914 + 15.729385375976562 + 124.01139068603516 + 123.3940200805664 = 1265.0989990234375
2024-10-26 19:28:43,776 - 13.372234344482422 + 14.590632438659668 + 14.607207298278809 + 117.64659881591797 + 117.1427230834961 = 1195.37939453125
2024-10-26 19:28:47,411 - 13.248476028442383 + 14.528645515441895 + 14.818257331848145 + 117.82965087890625 + 117.78137969970703 = 1191.5037841796875
2024-10-26 19:28:50,687 - 13.245712280273438 + 14.431136131286621 + 14.730508804321289 + 116.83489990234375 + 116.25434112548828 = 1186.991455078125
2024-10-26 19:28:53,796 - 12.895028114318848 + 14.100565910339355 + 14.287131309509277 + 114.7867660522461 + 114.6453857421875 = 1158.060546875
2024-10-26 19:28:56,876 - 13.354689598083496 + 14.464632034301758 + 14.733765602111816 + 116.41392517089844 + 116.22565460205078 = 1192.3580322265625
2024-10-26 19:29:00,069 - 13.67564582824707 + 14.840234756469727 + 15.051839828491211 + 119.38887786865234 + 118.60042572021484 = 1220.6923828125
2024-10-26 19:29:03,194 - 13.194985389709473 + 14.346633911132812 + 14.61567211151123 + 116.24282836914062 + 116.62149810791016 = 1182.236572265625
2024-10-26 19:29:06,335 - 13.741564750671387 + 15.077884674072266 + 15.199460983276367 + 120.855712890625 + 120.04913330078125 = 1230.756591796875
2024-10-26 19:29:09,422 - 13.054643630981445 + 14.375642776489258 + 14.577423095703125 + 116.81947326660156 + 116.58946990966797 = 1175.6717529296875
2024-10-26 19:29:12,502 - 12.987592697143555 + 14.287101745605469 + 14.5678071975708 + 115.1480484008789 + 115.63127136230469 = 1168.7080078125
2024-10-26 19:29:15,609 - 12.648284912109375 + 13.74051570892334 + 13.913393020629883 + 112.54063415527344 + 112.99771881103516 = 1134.49169921875
2024-10-26 19:29:18,731 - 12.958518028259277 + 14.168990135192871 + 14.470568656921387 + 114.54000091552734 + 115.13107299804688 = 1163.9925537109375
2024-10-26 19:29:22,114 - 12.346314430236816 + 13.61541748046875 + 13.921996116638184 + 111.7060317993164 + 111.59033203125 = 1115.986328125
2024-10-26 19:29:25,494 - 12.91028118133545 + 14.154560089111328 + 14.275032043457031 + 114.44168853759766 + 115.28628540039062 = 1159.537841796875
2024-10-26 19:29:28,814 - 13.16821575164795 + 14.456891059875488 + 14.756251335144043 + 116.84528350830078 + 116.7786636352539 = 1184.1661376953125
2024-10-26 19:29:32,099 - 12.529556274414062 + 13.702980995178223 + 13.939457893371582 + 110.87617492675781 + 111.58110809326172 = 1125.359375
2024-10-26 19:29:35,220 - 12.600285530090332 + 13.853460311889648 + 14.068841934204102 + 111.93183898925781 + 112.06104278564453 = 1133.230224609375
2024-10-26 19:29:37,348 - 8.370329856872559 + 9.609883308410645 + 9.866479873657227 + 77.8038330078125 + 77.53339385986328 = 768.6173095703125
2024-10-26 19:29:37,371 - epoch loss:1825.2766645951704
2024-10-26 19:29:37,371 - full_loss min:[8.370329856872559, 12.346314430236816], max:94.61028289794922, mean:20.645895125649194
2024-10-26 19:29:37,371 - ns1_loss min:[9.866479873657227, 13.913393020629883], max:95.1571044921875, mean:22.086375704678623
2024-10-26 19:29:37,371 - ns2_loss min:[9.609883308410645, 13.61541748046875], max:95.05110168457031, mean:21.870940520546654
2024-10-26 19:29:37,372 - ps1_loss min:[77.8038330078125, 110.87617492675781], max:765.7900390625, mean:176.84374445134944
2024-10-26 19:29:37,372 - ps2_loss min:[77.53339385986328, 111.58110809326172], max:765.0899047851562, mean:176.56499286998402
2024-10-26 19:29:37,372 - test
2024-10-26 19:29:37,374 - add_self_loops=True
2024-10-26 19:29:37,382 - net=ab_cosine_loss
2024-10-26 19:29:37,382 - test1...
2024-10-26 19:29:40,833 - k = 10
2024-10-26 19:29:40,863 - Acc@1=616/1000=0.616
2024-10-26 19:29:40,864 - Acc@2=721/1000=0.721
2024-10-26 19:29:40,864 - Acc@3=759/1000=0.759
2024-10-26 19:29:40,865 - Acc@4=791/1000=0.791
2024-10-26 19:29:40,866 - Acc@5=812/1000=0.812
2024-10-26 19:29:40,866 - Acc@6=831/1000=0.831
2024-10-26 19:29:40,867 - Acc@7=849/1000=0.849
2024-10-26 19:29:40,867 - Acc@8=860/1000=0.86
2024-10-26 19:29:40,868 - Acc@9=873/1000=0.873
2024-10-26 19:29:40,869 - Acc@10=880/1000=0.88
2024-10-26 19:29:40,870 - test2...
2024-10-26 19:29:48,238 - k = 10
2024-10-26 19:29:48,314 - Acc@1=1508/3000=0.502667
2024-10-26 19:29:48,315 - Acc@2=1837/3000=0.612333
2024-10-26 19:29:48,315 - Acc@3=2019/3000=0.673
2024-10-26 19:29:48,316 - Acc@4=2126/3000=0.708667
2024-10-26 19:29:48,317 - Acc@5=2196/3000=0.732
2024-10-26 19:29:48,317 - Acc@6=2257/3000=0.752333
2024-10-26 19:29:48,318 - Acc@7=2298/3000=0.766
2024-10-26 19:29:48,318 - Acc@8=2334/3000=0.778
2024-10-26 19:29:48,319 - Acc@9=2362/3000=0.787333
2024-10-26 19:29:48,319 - Acc@10=2395/3000=0.798333
