2024-10-21 10:36:58,688 - name: STEL_taxi_ab_augment_parameter_1_1_10
2024-10-21 10:36:58,688 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_augment_parameter_1_1_10', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 1, 'ratio_ns2': 1, 'ratio_ns1': 1, 'ratio_ps1': 10, 'ratio_ps2': 10}}
2024-10-21 10:36:58,688 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-21 10:36:58,688 - loading train tid...
2024-10-21 10:36:58,690 - loading test tid...
2024-10-21 10:36:59,004 - loading enhance sample...
2024-10-21 10:37:04,667 - data load completed
2024-10-21 10:37:04,667 - Executor...
2024-10-21 10:37:04,667 - device=cuda:0, in_dim=36, out_dim=32
2024-10-21 10:37:04,667 - train...
2024-10-21 10:37:04,670 - add_self_loops=True
2024-10-21 10:37:05,453 - lr=0.001, head=4
2024-10-21 10:37:05,453 - full_loss: dis_loss penalty = 0.1
2024-10-21 10:37:05,453 - Epoch 0/1
2024-10-21 10:37:21,871 - 1.2570884227752686 + 1.2584338188171387 + 1.2566815614700317 + 10.615555763244629 + 10.333711624145508 = 213.26486206054688
2024-10-21 10:37:26,049 - 0.5157111883163452 + 0.554867148399353 + 0.548563539981842 + 4.894745826721191 + 4.658809185028076 = 97.15469360351562
2024-10-21 10:37:27,645 - 0.2894913852214813 + 0.3307492136955261 + 0.35933026671409607 + 2.9084720611572266 + 2.9162843227386475 = 59.227134704589844
2024-10-21 10:37:29,287 - 0.20081979036331177 + 0.24154672026634216 + 0.24564090371131897 + 2.3435146808624268 + 2.2261767387390137 = 46.38492202758789
2024-10-21 10:37:30,727 - 0.16023686528205872 + 0.18665361404418945 + 0.2199060320854187 + 1.6709562540054321 + 1.5308902263641357 = 32.585262298583984
2024-10-21 10:37:32,220 - 0.19764426350593567 + 0.24991974234580994 + 0.24224981665611267 + 2.1506505012512207 + 1.902709722518921 = 41.22341537475586
2024-10-21 10:37:37,755 - 0.17749367654323578 + 0.21958287060260773 + 0.22164075076580048 + 2.0460033416748047 + 1.9589924812316895 = 40.66867446899414
2024-10-21 10:37:41,014 - 0.1470058262348175 + 0.18386659026145935 + 0.2077234387397766 + 1.6180787086486816 + 1.5406535863876343 = 32.12591552734375
2024-10-21 10:37:42,553 - 0.17107297480106354 + 0.21878907084465027 + 0.22317005693912506 + 1.8926397562026978 + 1.673285961151123 = 36.27228927612305
2024-10-21 10:37:44,045 - 0.1159946396946907 + 0.16322779655456543 + 0.1943659782409668 + 1.5927886962890625 + 1.5395152568817139 = 31.796628952026367
2024-10-21 10:37:45,674 - 0.1841321885585785 + 0.2273847460746765 + 0.22602149844169617 + 1.851701259613037 + 1.709657907485962 = 36.251129150390625
2024-10-21 10:37:47,138 - 0.20043203234672546 + 0.23773351311683655 + 0.24481670558452606 + 2.0329954624176025 + 1.8020331859588623 = 39.033267974853516
2024-10-21 10:37:52,383 - 0.12261153757572174 + 0.17852653563022614 + 0.1868322193622589 + 1.6403902769088745 + 1.4371026754379272 = 31.26289939880371
2024-10-21 10:37:57,757 - 0.09498685598373413 + 0.12991812825202942 + 0.15470176935195923 + 1.3331397771835327 + 1.3799891471862793 = 27.510896682739258
2024-10-21 10:37:59,225 - 0.09282226860523224 + 0.13088424503803253 + 0.1693360060453415 + 1.3543546199798584 + 1.292181134223938 = 26.858400344848633
2024-10-21 10:38:00,977 - 0.1313047707080841 + 0.16716031730175018 + 0.19046878814697266 + 1.5018680095672607 + 1.4203524589538574 = 29.711139678955078
2024-10-21 10:38:02,242 - 0.09737008810043335 + 0.14618533849716187 + 0.16932184994220734 + 1.3582799434661865 + 1.24742591381073 = 26.46993637084961
2024-10-21 10:38:03,593 - 0.09869760274887085 + 0.148232102394104 + 0.1467808187007904 + 1.338430643081665 + 1.1729017496109009 = 25.507034301757812
2024-10-21 10:38:09,724 - 0.10937903076410294 + 0.1563136875629425 + 0.1714981198310852 + 1.4157214164733887 + 1.2761304378509521 = 27.355709075927734
2024-10-21 10:38:12,742 - 0.09912082552909851 + 0.14635197818279266 + 0.15258891880512238 + 1.4276766777038574 + 1.24762761592865 = 27.151103973388672
2024-10-21 10:38:14,314 - 0.08923618495464325 + 0.13736507296562195 + 0.14293771982192993 + 1.3479435443878174 + 1.2552787065505981 = 26.40176010131836
2024-10-21 10:38:15,750 - 0.09562452882528305 + 0.13199381530284882 + 0.14593300223350525 + 1.1919445991516113 + 1.016864538192749 = 22.46164321899414
2024-10-21 10:38:17,300 - 0.0892648696899414 + 0.12282708287239075 + 0.12626948952674866 + 1.2421987056732178 + 1.1988847255706787 = 24.749197006225586
2024-10-21 10:38:19,284 - 0.10713065415620804 + 0.13507409393787384 + 0.14242303371429443 + 1.3773319721221924 + 1.2459008693695068 = 26.616954803466797
2024-10-21 10:38:22,334 - 0.11120057851076126 + 0.14845699071884155 + 0.1532871425151825 + 1.2261104583740234 + 1.0123990774154663 = 22.79804039001465
2024-10-21 10:38:27,214 - 0.08651714026927948 + 0.13084815442562103 + 0.12392629683017731 + 1.1378291845321655 + 0.9730619192123413 = 21.45020294189453
2024-10-21 10:38:30,041 - 0.06640152633190155 + 0.10043145716190338 + 0.09576287120580673 + 1.1054728031158447 + 0.9718656539916992 = 21.035980224609375
2024-10-21 10:38:31,436 - 0.050465550273656845 + 0.09507276117801666 + 0.10404358804225922 + 0.975621223449707 + 0.8832454085350037 = 18.83824920654297
2024-10-21 10:38:32,920 - 0.08093573153018951 + 0.11247297376394272 + 0.12775754928588867 + 1.0670421123504639 + 1.0399307012557983 = 21.39089584350586
2024-10-21 10:38:34,362 - 0.07957519590854645 + 0.11577515304088593 + 0.1141849160194397 + 1.1233758926391602 + 0.9767676591873169 = 21.310970306396484
2024-10-21 10:38:37,255 - 0.06638572365045547 + 0.11092527210712433 + 0.11216319352388382 + 1.0749694108963013 + 0.9302476644515991 = 20.341644287109375
2024-10-21 10:38:44,614 - 0.07936329394578934 + 0.11686187982559204 + 0.12005271762609482 + 1.127707600593567 + 1.0009596347808838 = 21.602949142456055
2024-10-21 10:38:46,114 - 0.07911773025989532 + 0.10897822678089142 + 0.11847862601280212 + 1.0158648490905762 + 0.9918638467788696 = 20.383861541748047
2024-10-21 10:38:47,715 - 0.08885686099529266 + 0.12049559503793716 + 0.11901131272315979 + 1.034566879272461 + 0.9819674491882324 = 20.49370574951172
2024-10-21 10:38:49,280 - 0.0740945115685463 + 0.10183268785476685 + 0.12398174405097961 + 1.0309317111968994 + 0.9403419494628906 = 20.012645721435547
2024-10-21 10:38:50,893 - 0.06650232523679733 + 0.09414823353290558 + 0.1056414246559143 + 0.9685872197151184 + 0.9135996103286743 = 19.088159561157227
2024-10-21 10:38:54,014 - 0.08444729447364807 + 0.12069601565599442 + 0.11907517910003662 + 1.1340209245681763 + 1.0438133478164673 = 22.102561950683594
2024-10-21 10:38:57,295 - 0.07112911343574524 + 0.10393904894590378 + 0.12322919070720673 + 1.0504456758499146 + 0.9184117317199707 = 19.98686981201172
2024-10-21 10:39:02,815 - 0.07547581195831299 + 0.1182076558470726 + 0.12123693525791168 + 1.1016615629196167 + 0.9903658032417297 = 21.23519515991211
2024-10-21 10:39:04,364 - 0.06675410270690918 + 0.0959574282169342 + 0.09965471923351288 + 0.9751524329185486 + 0.8772542476654053 = 18.786434173583984
2024-10-21 10:39:06,318 - 0.0696524828672409 + 0.10620620846748352 + 0.12114229053258896 + 0.9877491593360901 + 0.8916566967964172 = 19.091060638427734
2024-10-21 10:39:07,878 - 0.055195748805999756 + 0.07681262493133545 + 0.09029265493154526 + 0.8175839185714722 + 0.8221806287765503 = 16.61994743347168
2024-10-21 10:39:09,414 - 0.04857064411044121 + 0.07951684296131134 + 0.09859997034072876 + 0.78562331199646 + 0.7428984642028809 = 15.511905670166016
2024-10-21 10:39:12,249 - 0.06354448199272156 + 0.09425269067287445 + 0.09842368960380554 + 0.8905538320541382 + 0.8372699022293091 = 17.53445816040039
2024-10-21 10:39:19,315 - 0.07753854990005493 + 0.1076648086309433 + 0.11775317788124084 + 1.0783004760742188 + 0.8956142663955688 = 20.042102813720703
2024-10-21 10:39:20,850 - 0.06437405943870544 + 0.09825077652931213 + 0.10869118571281433 + 0.988688051700592 + 0.9246381521224976 = 19.404579162597656
2024-10-21 10:39:22,317 - 0.05065547302365303 + 0.0778028666973114 + 0.08819518983364105 + 0.8709044456481934 + 0.842772364616394 = 17.353422164916992
2024-10-21 10:39:23,871 - 0.04822666570544243 + 0.07353594154119492 + 0.08746222406625748 + 0.85016930103302 + 0.7951236367225647 = 16.662153244018555
2024-10-21 10:39:25,446 - 0.06686452031135559 + 0.09137465059757233 + 0.10635042935609818 + 0.9515296220779419 + 0.833329975605011 = 18.11318588256836
2024-10-21 10:39:26,955 - 0.05673115700483322 + 0.08698298782110214 + 0.09104093909263611 + 0.9393315315246582 + 0.8410561680793762 = 18.038631439208984
2024-10-21 10:39:33,262 - 0.05268727242946625 + 0.08487994223833084 + 0.08633624017238617 + 0.8936999440193176 + 0.8268320560455322 = 17.429222106933594
2024-10-21 10:39:34,630 - 0.06834276020526886 + 0.09081383049488068 + 0.10280020534992218 + 0.8221220374107361 + 0.6884980797767639 = 15.368158340454102
2024-10-21 10:39:36,033 - 0.05186784267425537 + 0.08157014846801758 + 0.08831574767827988 + 0.8195708990097046 + 0.7511112093925476 = 15.92857551574707
2024-10-21 10:39:37,466 - 0.05368025600910187 + 0.0845186859369278 + 0.10264114290475845 + 0.8433262705802917 + 0.7838118672370911 = 16.512222290039062
2024-10-21 10:39:38,242 - 0.031717631965875626 + 0.05987079441547394 + 0.06325271725654602 + 0.765458881855011 + 0.7280575037002563 = 15.090003967285156
2024-10-21 10:39:38,253 - epoch loss:29.410961185802112
2024-10-21 10:39:38,253 - full_loss min:[0.031717631965875626, 0.04822666570544243], max:1.2570884227752686, mean:0.12602808197790927
2024-10-21 10:39:38,253 - ns1_loss min:[0.06325271725654602, 0.08633624017238617], max:1.2566815614700317, mean:0.17130886356938968
2024-10-21 10:39:38,253 - ns2_loss min:[0.05987079441547394, 0.07353594154119492], max:1.2584338188171387, mean:0.16168619231744247
2024-10-21 10:39:38,253 - ps1_loss min:[0.765458881855011, 0.78562331199646], max:10.615555763244629, mean:1.5018428022211248
2024-10-21 10:39:38,253 - ps2_loss min:[0.6884980797767639, 0.7280575037002563], max:10.333711624145508, mean:1.3933510336008939
2024-10-21 10:39:38,253 - test
2024-10-21 10:39:38,255 - add_self_loops=True
2024-10-21 10:39:38,261 - net=ab_augment_parameter_1_1_10
2024-10-21 10:39:38,261 - test1...
2024-10-21 10:39:40,123 - k = 10
2024-10-21 10:39:40,145 - Acc@1=700/1000=0.7
2024-10-21 10:39:40,146 - Acc@2=796/1000=0.796
2024-10-21 10:39:40,146 - Acc@3=840/1000=0.84
2024-10-21 10:39:40,147 - Acc@4=870/1000=0.87
2024-10-21 10:39:40,147 - Acc@5=883/1000=0.883
2024-10-21 10:39:40,148 - Acc@6=902/1000=0.902
2024-10-21 10:39:40,149 - Acc@7=910/1000=0.91
2024-10-21 10:39:40,149 - Acc@8=922/1000=0.922
2024-10-21 10:39:40,150 - Acc@9=930/1000=0.93
2024-10-21 10:39:40,150 - Acc@10=936/1000=0.936
2024-10-21 10:39:40,151 - test2...
2024-10-21 10:39:43,864 - k = 10
2024-10-21 10:39:43,933 - Acc@1=1765/3000=0.588333
2024-10-21 10:39:43,934 - Acc@2=2083/3000=0.694333
2024-10-21 10:39:43,934 - Acc@3=2223/3000=0.741
2024-10-21 10:39:43,935 - Acc@4=2324/3000=0.774667
2024-10-21 10:39:43,935 - Acc@5=2400/3000=0.8
2024-10-21 10:39:43,936 - Acc@6=2452/3000=0.817333
2024-10-21 10:39:43,936 - Acc@7=2487/3000=0.829
2024-10-21 10:39:43,937 - Acc@8=2510/3000=0.836667
2024-10-21 10:39:43,938 - Acc@9=2533/3000=0.844333
2024-10-21 10:39:43,938 - Acc@10=2553/3000=0.851
