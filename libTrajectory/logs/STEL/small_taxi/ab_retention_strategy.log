2024-10-26 21:14:19,109 - name: STEL_taxi_ab_retention_strategy
2024-10-26 21:14:19,110 - config: {'path': './libTrajectory/dataset/small_taxi/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 36, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_retention_strategy', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 0, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 5, 'ratio_ns2': 1, 'ratio_ns1': 1}}
2024-10-26 21:14:19,110 - self.path=./libTrajectory/dataset/small_taxi/
2024-10-26 21:14:19,110 - loading train tid...
2024-10-26 21:14:19,111 - loading test tid...
2024-10-26 21:14:19,433 - loading enhance sample...
2024-10-26 21:14:24,889 - data load completed
2024-10-26 21:14:24,889 - retention_strategy
2024-10-26 21:14:24,890 - Executor...
2024-10-26 21:14:24,890 - device=cuda:0, in_dim=36, out_dim=32
2024-10-26 21:14:24,890 - train...
2024-10-26 21:14:24,893 - add_self_loops=True
2024-10-26 21:14:25,742 - lr=0.001, head=4
2024-10-26 21:14:25,742 - full_loss: dis_loss penalty = 0.1
2024-10-26 21:14:25,742 - Epoch 0/1
2024-10-26 21:14:39,142 - 0.5481001138687134 + 0.5474186539649963 + 0.5199416279792786 + 0 + 0 = 3.8078606128692627
2024-10-26 21:14:39,955 - 0.29221242666244507 + 0.2910524010658264 + 0.3045536279678345 + 0 + 0 = 2.056668281555176
2024-10-26 21:14:40,198 - 0.24976815283298492 + 0.24746224284172058 + 0.24470879137516022 + 0 + 0 = 1.7410118579864502
2024-10-26 21:14:40,429 - 0.21416205167770386 + 0.2141038477420807 + 0.21026188135147095 + 0 + 0 = 1.495176076889038
2024-10-26 21:14:40,652 - 0.2220676839351654 + 0.2220676839351654 + 0.20633012056350708 + 0 + 0 = 1.538736343383789
2024-10-26 21:14:40,897 - 0.16658669710159302 + 0.16619282960891724 + 0.1598294973373413 + 0 + 0 = 1.1589558124542236
2024-10-26 21:14:48,469 - 0.18204790353775024 + 0.18182718753814697 + 0.1795223355293274 + 0 + 0 = 1.2715890407562256
2024-10-26 21:14:52,014 - 0.15465551614761353 + 0.15465551614761353 + 0.14625924825668335 + 0 + 0 = 1.0741922855377197
2024-10-26 21:14:52,218 - 0.12089915573596954 + 0.12089917063713074 + 0.11103690415620804 + 0 + 0 = 0.8364318609237671
2024-10-26 21:14:52,427 - 0.1760643720626831 + 0.1760643720626831 + 0.1634446084499359 + 0 + 0 = 1.219830870628357
2024-10-26 21:14:52,625 - 0.13062597811222076 + 0.1303616762161255 + 0.13104034960269928 + 0 + 0 = 0.9145318865776062
2024-10-26 21:14:52,849 - 0.16226591169834137 + 0.16211161017417908 + 0.15779529511928558 + 0 + 0 = 1.1312364339828491
2024-10-26 21:15:00,214 - 0.12678633630275726 + 0.12547409534454346 + 0.12460638582706451 + 0 + 0 = 0.8840121626853943
2024-10-26 21:15:03,456 - 0.11884957551956177 + 0.11884958297014236 + 0.11561566591262817 + 0 + 0 = 0.8287131190299988
2024-10-26 21:15:03,715 - 0.15548956394195557 + 0.15548956394195557 + 0.15127205848693848 + 0 + 0 = 1.0842094421386719
2024-10-26 21:15:03,893 - 0.10220777988433838 + 0.10209523886442184 + 0.10250288993120193 + 0 + 0 = 0.7156370282173157
2024-10-26 21:15:04,114 - 0.09673120826482773 + 0.09673120826482773 + 0.09270945936441422 + 0 + 0 = 0.6730967164039612
2024-10-26 21:15:07,084 - 0.11503587663173676 + 0.11486448347568512 + 0.11412636935710907 + 0 + 0 = 0.8041702508926392
2024-10-26 21:15:09,257 - 0.09359143674373627 + 0.09359143674373627 + 0.0934019386768341 + 0 + 0 = 0.6549506187438965
2024-10-26 21:15:16,356 - 0.07722148299217224 + 0.07710729539394379 + 0.07690384238958359 + 0 + 0 = 0.5401185154914856
2024-10-26 21:15:16,614 - 0.10903749614953995 + 0.10903424024581909 + 0.10823282599449158 + 0 + 0 = 0.7624545097351074
2024-10-26 21:15:16,848 - 0.08012960106134415 + 0.07953289151191711 + 0.07729844003915787 + 0 + 0 = 0.5574793219566345
2024-10-26 21:15:17,082 - 0.08926236629486084 + 0.08876357227563858 + 0.08866630494594574 + 0 + 0 = 0.6237417459487915
2024-10-26 21:15:17,485 - 0.10290750861167908 + 0.10290753096342087 + 0.10052609443664551 + 0 + 0 = 0.7179712057113647
2024-10-26 21:15:21,438 - 0.09549295902252197 + 0.09389603137969971 + 0.09335611760616302 + 0 + 0 = 0.6647169589996338
2024-10-26 21:15:27,437 - 0.11863340437412262 + 0.11848685145378113 + 0.11641065031290054 + 0 + 0 = 0.828064501285553
2024-10-26 21:15:27,654 - 0.06976556777954102 + 0.06976556777954102 + 0.07010573148727417 + 0 + 0 = 0.48869913816452026
2024-10-26 21:15:27,914 - 0.09376034885644913 + 0.09280478954315186 + 0.09781798720359802 + 0 + 0 = 0.6594245433807373
2024-10-26 21:15:28,154 - 0.06517686694860458 + 0.06513141095638275 + 0.06440413743257523 + 0 + 0 = 0.4554198980331421
2024-10-26 21:15:30,581 - 0.08170297741889954 + 0.0807945504784584 + 0.07983814179897308 + 0 + 0 = 0.5691475868225098
2024-10-26 21:15:33,881 - 0.09229347854852676 + 0.09182608127593994 + 0.08889655768871307 + 0 + 0 = 0.6421900391578674
2024-10-26 21:15:37,537 - 0.07372494786977768 + 0.07372494786977768 + 0.07341013848781586 + 0 + 0 = 0.5157598257064819
2024-10-26 21:15:37,775 - 0.04726787656545639 + 0.04726788401603699 + 0.04630360007286072 + 0 + 0 = 0.32991087436676025
2024-10-26 21:15:37,970 - 0.06647363305091858 + 0.06645206362009048 + 0.0670560672879219 + 0 + 0 = 0.4658762812614441
2024-10-26 21:15:38,184 - 0.0657224953174591 + 0.06572248041629791 + 0.0652846097946167 + 0 + 0 = 0.45961958169937134
2024-10-26 21:15:41,530 - 0.039895325899124146 + 0.039795272052288055 + 0.03927537798881531 + 0 + 0 = 0.2785472869873047
2024-10-26 21:15:46,791 - 0.06387098133563995 + 0.06387098133563995 + 0.06425541639328003 + 0 + 0 = 0.44748127460479736
2024-10-26 21:15:49,687 - 0.06820537894964218 + 0.06776751577854156 + 0.06732016801834106 + 0 + 0 = 0.47611457109451294
2024-10-26 21:15:49,892 - 0.0816098004579544 + 0.08054531365633011 + 0.08097368478775024 + 0 + 0 = 0.5695679783821106
2024-10-26 21:15:50,114 - 0.07271758466959 + 0.0727175921201706 + 0.0739930123090744 + 0 + 0 = 0.5102985501289368
2024-10-26 21:15:50,376 - 0.06765097379684448 + 0.06755603104829788 + 0.06770692765712738 + 0 + 0 = 0.47351783514022827
2024-10-26 21:15:51,190 - 0.0540107861161232 + 0.05400245636701584 + 0.05387323349714279 + 0 + 0 = 0.3779296278953552
2024-10-26 21:15:58,525 - 0.043997690081596375 + 0.04389822855591774 + 0.04217436909675598 + 0 + 0 = 0.3060610592365265
2024-10-26 21:15:59,898 - 0.06500453501939774 + 0.06459978967905045 + 0.06343133002519608 + 0 + 0 = 0.4530537724494934
2024-10-26 21:16:00,149 - 0.04968634992837906 + 0.049340564757585526 + 0.05002504587173462 + 0 + 0 = 0.34779736399650574
2024-10-26 21:16:00,414 - 0.059482816606760025 + 0.05788213014602661 + 0.06020040810108185 + 0 + 0 = 0.4154966473579407
2024-10-26 21:16:00,667 - 0.0723971426486969 + 0.07175633311271667 + 0.07469864189624786 + 0 + 0 = 0.5084406733512878
2024-10-26 21:16:00,903 - 0.05499035120010376 + 0.05493966117501259 + 0.054279960691928864 + 0 + 0 = 0.38417136669158936
2024-10-26 21:16:10,353 - 0.08164483308792114 + 0.08164481818675995 + 0.08117334544658661 + 0 + 0 = 0.5710423588752747
2024-10-26 21:16:13,071 - 0.07106105983257294 + 0.07060301303863525 + 0.06781713664531708 + 0 + 0 = 0.4937254786491394
2024-10-26 21:16:13,314 - 0.08201858401298523 + 0.08201858401298523 + 0.0823085606098175 + 0 + 0 = 0.5744200944900513
2024-10-26 21:16:13,500 - 0.06195059418678284 + 0.06195060908794403 + 0.06238657981157303 + 0 + 0 = 0.43409013748168945
2024-10-26 21:16:13,720 - 0.05375988036394119 + 0.05373218655586243 + 0.05391936004161835 + 0 + 0 = 0.37645095586776733
2024-10-26 21:16:13,928 - 0.05161970853805542 + 0.05121230334043503 + 0.050619080662727356 + 0 + 0 = 0.3599299192428589
2024-10-26 21:16:17,418 - 0.051877085119485855 + 0.05181250348687172 + 0.051102470606565475 + 0 + 0 = 0.36230039596557617
2024-10-26 21:16:17,429 - epoch loss:0.761673501404849
2024-10-26 21:16:17,429 - full_loss min:[0.039895325899124146, 0.043997690081596375], max:0.5481001138687134, mean:0.10916676751591943
2024-10-26 21:16:17,429 - ns1_loss min:[0.03927537798881531, 0.04217436909675598], max:0.5199416279792786, mean:0.10700008022514257
2024-10-26 21:16:17,429 - ns2_loss min:[0.039795272052288055, 0.04389822855591774], max:0.5474186539649963, mean:0.10883957960388878
2024-10-26 21:16:17,429 - test
2024-10-26 21:16:17,432 - add_self_loops=True
2024-10-26 21:16:17,438 - net=ab_retention_strategy
2024-10-26 21:16:17,438 - test1...
2024-10-26 21:16:19,416 - k = 10
2024-10-26 21:16:19,438 - Acc@1=698/1000=0.698
2024-10-26 21:16:19,439 - Acc@2=795/1000=0.795
2024-10-26 21:16:19,439 - Acc@3=838/1000=0.838
2024-10-26 21:16:19,440 - Acc@4=857/1000=0.857
2024-10-26 21:16:19,440 - Acc@5=879/1000=0.879
2024-10-26 21:16:19,441 - Acc@6=892/1000=0.892
2024-10-26 21:16:19,441 - Acc@7=903/1000=0.903
2024-10-26 21:16:19,442 - Acc@8=916/1000=0.916
2024-10-26 21:16:19,442 - Acc@9=928/1000=0.928
2024-10-26 21:16:19,443 - Acc@10=937/1000=0.937
2024-10-26 21:16:19,443 - test2...
2024-10-26 21:16:23,713 - k = 10
2024-10-26 21:16:23,784 - Acc@1=1786/3000=0.595333
2024-10-26 21:16:23,784 - Acc@2=2103/3000=0.701
2024-10-26 21:16:23,785 - Acc@3=2257/3000=0.752333
2024-10-26 21:16:23,785 - Acc@4=2349/3000=0.783
2024-10-26 21:16:23,786 - Acc@5=2415/3000=0.805
2024-10-26 21:16:23,786 - Acc@6=2460/3000=0.82
2024-10-26 21:16:23,787 - Acc@7=2507/3000=0.835667
2024-10-26 21:16:23,787 - Acc@8=2541/3000=0.847
2024-10-26 21:16:23,788 - Acc@9=2570/3000=0.856667
2024-10-26 21:16:23,788 - Acc@10=2587/3000=0.862333
