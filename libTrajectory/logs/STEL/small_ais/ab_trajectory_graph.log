2024-10-26 18:02:26,792 - name: STEL_ais_ab_trajectory_graph
2024-10-26 18:02:26,792 - config: {'path': './libTrajectory/dataset/small_ais/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 34, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_trajectory_graph', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 18:02:26,792 - self.path=./libTrajectory/dataset/small_ais/
2024-10-26 18:02:26,792 - loading train tid...
2024-10-26 18:02:26,794 - loading test tid...
2024-10-26 18:02:27,436 - loading enhance sample...
2024-10-26 18:02:37,339 - data load completed
2024-10-26 18:02:37,340 - trajectory_graph
2024-10-26 18:02:37,340 - Executor...
2024-10-26 18:02:37,340 - device=cuda:0, in_dim=34, out_dim=32
2024-10-26 18:02:37,341 - train...
2024-10-26 18:02:37,343 - add_self_loops=True
2024-10-26 18:02:38,459 - lr=0.001, head=4
2024-10-26 18:02:38,459 - full_loss: dis_loss penalty = 0.1
2024-10-26 18:02:38,459 - Epoch 0/1
2024-10-26 18:02:56,817 - 0.5960360765457153 + 0.66014164686203 + 0.6502866148948669 + 5.321901798248291 + 4.966170787811279 = 53.19416046142578
2024-10-26 18:02:57,885 - 0.3517009913921356 + 0.41847699880599976 + 0.391679972410202 + 3.4010117053985596 + 3.1243844032287598 = 32.21201705932617
2024-10-26 18:02:59,166 - 0.25206610560417175 + 0.3487379848957062 + 0.3474627137184143 + 2.837191581726074 + 2.6485822200775146 = 25.05108642578125
2024-10-26 18:03:00,629 - 0.2570384740829468 + 0.3524705171585083 + 0.34266334772109985 + 2.870213031768799 + 2.6126604080200195 = 25.286136627197266
2024-10-26 18:03:02,379 - 0.24126183986663818 + 0.3126533627510071 + 0.34615421295166016 + 2.562429666519165 + 2.3963918685913086 = 23.609989166259766
2024-10-26 18:03:03,914 - 0.16405905783176422 + 0.2374372035264969 + 0.2535568177700043 + 1.958739995956421 + 2.0616774559020996 = 17.133312225341797
2024-10-26 18:03:12,994 - 0.16854998469352722 + 0.24198059737682343 + 0.24998849630355835 + 1.9894450902938843 + 1.8297947645187378 = 17.16642951965332
2024-10-26 18:03:14,425 - 0.1756206452846527 + 0.2574023902416229 + 0.26786237955093384 + 2.0983002185821533 + 1.9506688117980957 = 18.08264923095703
2024-10-26 18:03:15,615 - 0.18025970458984375 + 0.2524164915084839 + 0.26528507471084595 + 2.080425500869751 + 1.8773761987686157 = 18.147802352905273
2024-10-26 18:03:16,923 - 0.15807726979255676 + 0.24354100227355957 + 0.2660565674304962 + 2.0051686763763428 + 1.9411976337432861 = 16.946205139160156
2024-10-26 18:03:18,524 - 0.14184334874153137 + 0.2274208664894104 + 0.22036126255989075 + 1.9075002670288086 + 1.7737786769866943 = 15.251267433166504
2024-10-26 18:03:19,814 - 0.12109494209289551 + 0.19420810043811798 + 0.19103312492370605 + 1.6295068264007568 + 1.5087909698486328 = 13.04545783996582
2024-10-26 18:03:25,958 - 0.12885908782482147 + 0.22318331897258759 + 0.22267694771289825 + 1.840421438217163 + 1.6268033981323242 = 14.368782043457031
2024-10-26 18:03:27,471 - 0.12585656344890594 + 0.22719243168830872 + 0.21528370678424835 + 1.8838709592819214 + 1.6506673097610474 = 14.252127647399902
2024-10-26 18:03:29,173 - 0.11428868770599365 + 0.1809946745634079 + 0.1797017902135849 + 1.491706132888794 + 1.5312507152557373 = 12.344356536865234
2024-10-26 18:03:30,864 - 0.13213393092155457 + 0.23815344274044037 + 0.2276599258184433 + 1.9570995569229126 + 1.8203054666519165 = 15.042235374450684
2024-10-26 18:03:32,380 - 0.11708833277225494 + 0.19539009034633636 + 0.20584407448768616 + 1.6256722211837769 + 1.6602966785430908 = 13.152727127075195
2024-10-26 18:03:33,744 - 0.11548162996768951 + 0.19337452948093414 + 0.21415677666664124 + 1.614891767501831 + 1.5867277383804321 = 13.05101490020752
2024-10-26 18:03:42,143 - 0.11269967257976532 + 0.19474177062511444 + 0.1973046511411667 + 1.610641360282898 + 1.5224608182907104 = 12.688549995422363
2024-10-26 18:03:43,294 - 0.0979936271905899 + 0.16503781080245972 + 0.17729949951171875 + 1.3700309991836548 + 1.3701995611190796 = 11.063285827636719
2024-10-26 18:03:44,516 - 0.09827803075313568 + 0.155483216047287 + 0.18527452647686005 + 1.324150562286377 + 1.1689307689666748 = 10.814560890197754
2024-10-26 18:03:45,983 - 0.09944610297679901 + 0.18455392122268677 + 0.17460209131240845 + 1.5470099449157715 + 1.4693424701690674 = 11.580218315124512
2024-10-26 18:03:48,067 - 0.10576176643371582 + 0.16573566198349 + 0.19276991486549377 + 1.3844828605651855 + 1.4504945278167725 = 11.708122253417969
2024-10-26 18:03:49,556 - 0.08655771613121033 + 0.1422080099582672 + 0.155166357755661 + 1.1868693828582764 + 1.1761250495910645 = 9.664623260498047
2024-10-26 18:03:59,515 - 0.09695616364479065 + 0.16919741034507751 + 0.1757521629333496 + 1.3946998119354248 + 1.3811020851135254 = 11.07310676574707
2024-10-26 18:04:01,046 - 0.11145716160535812 + 0.18053577840328217 + 0.1722775548696518 + 1.4716212749481201 + 1.3716601133346558 = 11.944272994995117
2024-10-26 18:04:02,632 - 0.11208902299404144 + 0.16450455784797668 + 0.16472545266151428 + 1.3559954166412354 + 1.2445694208145142 = 11.497316360473633
2024-10-26 18:04:03,986 - 0.0811806172132492 + 0.1557748168706894 + 0.14835646748542786 + 1.2997792959213257 + 1.1913812160491943 = 9.591504096984863
2024-10-26 18:04:05,326 - 0.09150960296392441 + 0.15123403072357178 + 0.15534666180610657 + 1.2367953062057495 + 1.274161458015442 = 10.152243614196777
2024-10-26 18:04:06,520 - 0.08046737313270569 + 0.1369122564792633 + 0.14930936694145203 + 1.155418038368225 + 1.1700761318206787 = 9.211079597473145
2024-10-26 18:04:13,466 - 0.08473382890224457 + 0.16089439392089844 + 0.15848533809185028 + 1.32271409034729 + 1.2658809423446655 = 10.019083023071289
2024-10-26 18:04:15,355 - 0.08511994034051895 + 0.16088026762008667 + 0.1663585752248764 + 1.333003282546997 + 1.3795456886291504 = 10.240934371948242
2024-10-26 18:04:17,101 - 0.09073041379451752 + 0.14478963613510132 + 0.15151247382164001 + 1.2439663410186768 + 1.1917680501937866 = 9.93527603149414
2024-10-26 18:04:18,819 - 0.0754612386226654 + 0.13652165234088898 + 0.1381951868534088 + 1.1525007486343384 + 1.1202657222747803 = 8.792996406555176
2024-10-26 18:04:20,051 - 0.08894360810518265 + 0.15316173434257507 + 0.15420104563236237 + 1.2484445571899414 + 1.1354864835739136 = 9.904739379882812
2024-10-26 18:04:21,927 - 0.08778370916843414 + 0.1482391655445099 + 0.14796867966651917 + 1.2312361001968384 + 1.166272521018982 = 9.748772621154785
2024-10-26 18:04:25,938 - 0.07072410732507706 + 0.1291503608226776 + 0.13023307919502258 + 1.0821470022201538 + 1.140028715133667 = 8.352215766906738
2024-10-26 18:04:27,349 - 0.07962784171104431 + 0.1305922269821167 + 0.13763582706451416 + 1.0786899328231812 + 1.0662788152694702 = 8.80864143371582
2024-10-26 18:04:29,149 - 0.07227680087089539 + 0.12894320487976074 + 0.12703000009059906 + 1.0692126750946045 + 1.0632085800170898 = 8.30599308013916
2024-10-26 18:04:34,071 - 0.07031817734241486 + 0.12825429439544678 + 0.12946319580078125 + 1.0479273796081543 + 1.03678297996521 = 8.177794456481934
2024-10-26 18:04:35,535 - 0.06474079191684723 + 0.12908542156219482 + 0.12707185745239258 + 1.0654457807540894 + 1.1219345331192017 = 7.985992908477783
2024-10-26 18:04:37,139 - 0.07785826921463013 + 0.13871538639068604 + 0.13863006234169006 + 1.1492565870285034 + 1.0788284540176392 = 8.894453048706055
2024-10-26 18:04:42,060 - 0.07665466517210007 + 0.13092908263206482 + 0.14231550693511963 + 1.0875169038772583 + 1.0839797258377075 = 8.736675262451172
2024-10-26 18:04:43,277 - 0.06533762812614441 + 0.12167048454284668 + 0.13397008180618286 + 1.0446882247924805 + 0.9711558222770691 = 7.839130878448486
2024-10-26 18:04:44,944 - 0.0761638656258583 + 0.1353253871202469 + 0.1439136266708374 + 1.1122093200683594 + 1.0369415283203125 = 8.749733924865723
2024-10-26 18:04:46,074 - 0.0799098014831543 + 0.13324403762817383 + 0.12563776969909668 + 1.101321816444397 + 1.0902087688446045 = 8.775838851928711
2024-10-26 18:04:47,287 - 0.06792560964822769 + 0.13666872680187225 + 0.13225296139717102 + 1.1277439594268799 + 1.0931282043457031 = 8.30636978149414
2024-10-26 18:04:48,687 - 0.07849553227424622 + 0.12064208090305328 + 0.11940661817789078 + 0.9913809299468994 + 0.9651862978935242 = 8.281830787658691
2024-10-26 18:04:54,236 - 0.061858296394348145 + 0.11576348543167114 + 0.11569806188344955 + 0.9595238566398621 + 0.9787576198577881 = 7.34581184387207
2024-10-26 18:04:55,817 - 0.08116383850574493 + 0.1253623366355896 + 0.1358794867992401 + 1.0327993631362915 + 1.0795198678970337 = 8.782929420471191
2024-10-26 18:04:56,803 - 0.06472322344779968 + 0.11682374030351639 + 0.11885882914066315 + 0.9860271215438843 + 0.9216519594192505 = 7.50066614151001
2024-10-26 18:04:57,940 - 0.06633514165878296 + 0.10956229269504547 + 0.11224329471588135 + 0.9260851740837097 + 0.9215566515922546 = 7.3824543952941895
2024-10-26 18:04:59,208 - 0.07343034446239471 + 0.1173095852136612 + 0.11668559908866882 + 0.9722502827644348 + 0.9329869151115417 = 7.916706085205078
2024-10-26 18:05:00,523 - 0.055147211998701096 + 0.11187265813350677 + 0.1080855056643486 + 0.9262223839759827 + 0.9310792684555054 = 6.814243793487549
2024-10-26 18:05:03,216 - 0.05511951446533203 + 0.10839439928531647 + 0.1120212972164154 + 0.9026687741279602 + 0.9583770632743835 = 6.821178436279297
2024-10-26 18:05:03,230 - epoch loss:12.740856422077526
2024-10-26 18:05:03,230 - full_loss min:[0.05511951446533203, 0.055147211998701096], max:0.5960360765457153, mean:0.11938721693374894
2024-10-26 18:05:03,230 - ns1_loss min:[0.1080855056643486, 0.1120212972164154], max:0.6502866148948669, mean:0.18963004499673844
2024-10-26 18:05:03,231 - ns2_loss min:[0.10839439928531647, 0.10956229269504547], max:0.66014164686203, mean:0.1862525624307719
2024-10-26 18:05:03,231 - ps1_loss min:[0.9026687741279602, 0.9260851740837097], max:5.321901798248291, mean:1.5383267868648876
2024-10-26 18:05:03,231 - ps2_loss min:[0.9215566515922546, 0.9216519594192505], max:4.966170787811279, mean:1.4743425510146402
2024-10-26 18:05:03,231 - test
2024-10-26 18:05:03,233 - add_self_loops=True
2024-10-26 18:05:03,240 - net=ab_trajectory_graph
2024-10-26 18:05:03,240 - test1...
2024-10-26 18:05:06,544 - k = 10
2024-10-26 18:05:06,570 - Acc@1=568/1000=0.568
2024-10-26 18:05:06,571 - Acc@2=675/1000=0.675
2024-10-26 18:05:06,572 - Acc@3=730/1000=0.73
2024-10-26 18:05:06,572 - Acc@4=774/1000=0.774
2024-10-26 18:05:06,573 - Acc@5=811/1000=0.811
2024-10-26 18:05:06,573 - Acc@6=840/1000=0.84
2024-10-26 18:05:06,574 - Acc@7=857/1000=0.857
2024-10-26 18:05:06,574 - Acc@8=873/1000=0.873
2024-10-26 18:05:06,575 - Acc@9=888/1000=0.888
2024-10-26 18:05:06,575 - Acc@10=900/1000=0.9
2024-10-26 18:05:06,576 - test2...
2024-10-26 18:05:13,912 - k = 10
2024-10-26 18:05:14,000 - Acc@1=1261/3000=0.420333
2024-10-26 18:05:14,000 - Acc@2=1648/3000=0.549333
2024-10-26 18:05:14,001 - Acc@3=1842/3000=0.614
2024-10-26 18:05:14,002 - Acc@4=1983/3000=0.661
2024-10-26 18:05:14,002 - Acc@5=2085/3000=0.695
2024-10-26 18:05:14,003 - Acc@6=2164/3000=0.721333
2024-10-26 18:05:14,003 - Acc@7=2226/3000=0.742
2024-10-26 18:05:14,004 - Acc@8=2272/3000=0.757333
2024-10-26 18:05:14,004 - Acc@9=2330/3000=0.776667
2024-10-26 18:05:14,005 - Acc@10=2365/3000=0.788333
