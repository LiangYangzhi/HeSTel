2024-10-26 19:15:58,754 - name: STEL_ais_ab_cosine_loss
2024-10-26 19:15:58,754 - config: {'path': './libTrajectory/dataset/small_ais/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 34, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_cosine_loss', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 19:15:58,754 - self.path=./libTrajectory/dataset/small_ais/
2024-10-26 19:15:58,754 - loading train tid...
2024-10-26 19:15:58,756 - loading test tid...
2024-10-26 19:15:59,434 - loading enhance sample...
2024-10-26 19:16:08,531 - data load completed
2024-10-26 19:16:08,531 - cosine_loss
2024-10-26 19:16:08,531 - Executor...
2024-10-26 19:16:08,532 - device=cuda:0, in_dim=34, out_dim=32
2024-10-26 19:16:08,532 - train...
2024-10-26 19:16:08,532 - add_self_loops=True
2024-10-26 19:16:09,345 - lr=0.001, head=4
2024-10-26 19:16:09,345 - Epoch 0/1
2024-10-26 19:16:29,555 - 77.18273162841797 + 78.33000183105469 + 78.30623626708984 + 630.7137451171875 + 630.2587890625 = 6686.4716796875
2024-10-26 19:16:33,260 - 65.12726593017578 + 66.36974334716797 + 66.52748107910156 + 533.0991821289062 + 527.28759765625 = 5645.72216796875
2024-10-26 19:16:37,057 - 48.868221282958984 + 50.74245071411133 + 50.731937408447266 + 410.93853759765625 + 410.7740783691406 = 4279.86767578125
2024-10-26 19:16:40,583 - 35.775718688964844 + 37.82132339477539 + 37.75727462768555 + 304.3450927734375 + 301.79486083984375 = 3150.7119140625
2024-10-26 19:16:43,748 - 26.322715759277344 + 28.627656936645508 + 28.603687286376953 + 230.50863647460938 + 230.1881866455078 = 2349.14599609375
2024-10-26 19:16:47,451 - 20.78805923461914 + 23.043508529663086 + 22.955915451049805 + 185.38800048828125 + 185.88702392578125 = 1870.672119140625
2024-10-26 19:16:52,108 - 18.528200149536133 + 20.656517028808594 + 20.808671951293945 + 166.54498291015625 + 166.87986755371094 = 1674.48681640625
2024-10-26 19:16:55,707 - 17.356714248657227 + 19.73270606994629 + 19.918760299682617 + 158.36827087402344 + 159.406005859375 = 1582.1246337890625
2024-10-26 19:16:59,740 - 16.994129180908203 + 19.327407836914062 + 19.39740562438965 + 155.1272735595703 + 154.69290161132812 = 1546.7747802734375
2024-10-26 19:17:03,000 - 17.145132064819336 + 19.293476104736328 + 19.381420135498047 + 154.37612915039062 + 152.94033813476562 = 1551.322021484375
2024-10-26 19:17:06,174 - 16.851593017578125 + 18.983060836791992 + 19.09641456604004 + 152.89401245117188 + 152.44842529296875 = 1528.716796875
2024-10-26 19:17:09,248 - 17.261459350585938 + 19.465852737426758 + 19.537586212158203 + 156.71258544921875 + 156.58197021484375 = 1566.402099609375
2024-10-26 19:17:13,336 - 17.28182601928711 + 19.501537322998047 + 19.6254825592041 + 157.53662109375 + 157.72482299804688 = 1570.623046875
2024-10-26 19:17:16,670 - 17.340999603271484 + 19.5755672454834 + 19.644071578979492 + 156.37364196777344 + 157.64500427246094 = 1573.2650146484375
2024-10-26 19:17:19,753 - 17.438304901123047 + 19.53101921081543 + 19.541391372680664 + 156.96029663085938 + 158.7717742919922 = 1578.3714599609375
2024-10-26 19:17:23,087 - 16.76651954650879 + 19.16383171081543 + 19.353403091430664 + 155.86082458496094 + 158.41737365722656 = 1537.776611328125
2024-10-26 19:17:26,171 - 17.47126007080078 + 19.505849838256836 + 19.54499053955078 + 157.17745971679688 + 155.21917724609375 = 1576.468017578125
2024-10-26 19:17:29,186 - 15.818794250488281 + 18.03388214111328 + 18.007770538330078 + 146.10231018066406 + 148.0693359375 = 1445.52783203125
2024-10-26 19:17:32,387 - 15.762351989746094 + 18.22286605834961 + 18.134490966796875 + 146.79637145996094 + 148.78683471679688 = 1447.2744140625
2024-10-26 19:17:35,505 - 15.397279739379883 + 17.529987335205078 + 17.628326416015625 + 140.94943237304688 + 142.45901489257812 = 1404.8555908203125
2024-10-26 19:17:38,611 - 15.023083686828613 + 17.28498077392578 + 17.364646911621094 + 138.52296447753906 + 138.88978576660156 = 1375.0631103515625
2024-10-26 19:17:42,090 - 15.156898498535156 + 17.323644638061523 + 17.244144439697266 + 139.1611785888672 + 140.9429931640625 = 1383.626953125
2024-10-26 19:17:45,325 - 14.534701347351074 + 16.768054962158203 + 16.85089111328125 + 134.76292419433594 + 135.084716796875 = 1332.772216796875
2024-10-26 19:17:48,438 - 14.701568603515625 + 17.023597717285156 + 17.016395568847656 + 138.42295837402344 + 139.5995635986328 = 1353.5009765625
2024-10-26 19:17:51,536 - 14.646042823791504 + 16.484638214111328 + 16.72247886657715 + 132.32667541503906 + 134.19174194335938 = 1330.8917236328125
2024-10-26 19:17:54,540 - 13.91758918762207 + 15.984198570251465 + 16.078289031982422 + 128.7686767578125 + 129.50689697265625 = 1274.77978515625
2024-10-26 19:17:57,626 - 13.802912712097168 + 16.100601196289062 + 16.052780151367188 + 128.7935333251953 + 129.78326416015625 = 1270.25634765625
2024-10-26 19:18:01,214 - 14.083924293518066 + 16.207185745239258 + 16.52093505859375 + 129.04750061035156 + 129.89202880859375 = 1290.4169921875
2024-10-26 19:18:04,423 - 14.210777282714844 + 16.50286102294922 + 16.664148330688477 + 132.2543182373047 + 132.47518920898438 = 1306.9384765625
2024-10-26 19:18:07,578 - 13.447668075561523 + 15.76419734954834 + 15.889378547668457 + 125.64146423339844 + 126.76332092285156 = 1241.323974609375
2024-10-26 19:18:10,734 - 13.595853805541992 + 15.858198165893555 + 15.891016006469727 + 126.94628143310547 + 127.55242156982422 = 1251.783447265625
2024-10-26 19:18:13,799 - 13.437088966369629 + 15.673297882080078 + 15.831921577453613 + 125.5118408203125 + 125.88677978515625 = 1238.30517578125
2024-10-26 19:18:16,844 - 13.389904022216797 + 15.72988224029541 + 15.68996810913086 + 126.23347473144531 + 127.81627655029297 = 1237.7435302734375
2024-10-26 19:18:19,923 - 13.585549354553223 + 15.792060852050781 + 15.786205291748047 + 126.4095230102539 + 127.95743560791016 = 1249.427001953125
2024-10-26 19:18:23,190 - 13.437249183654785 + 15.527268409729004 + 15.454705238342285 + 124.35130310058594 + 126.98381805419922 = 1233.017333984375
2024-10-26 19:18:26,185 - 12.863409042358398 + 15.212409019470215 + 15.168041229248047 + 121.59845733642578 + 124.23942565917969 = 1192.8128662109375
2024-10-26 19:18:29,425 - 13.206637382507324 + 15.2326021194458 + 15.204721450805664 + 121.5792007446289 + 123.48882293701172 = 1209.7730712890625
2024-10-26 19:18:32,551 - 13.518600463867188 + 15.76392650604248 + 15.840519905090332 + 125.23612976074219 + 126.05094146728516 = 1243.2615966796875
2024-10-26 19:18:35,605 - 12.881011962890625 + 14.775943756103516 + 14.981573104858398 + 117.91242980957031 + 119.28692626953125 = 1178.8251953125
2024-10-26 19:18:38,815 - 12.959543228149414 + 14.952630043029785 + 15.00631332397461 + 119.20116424560547 + 121.242919921875 = 1188.0107421875
2024-10-26 19:18:42,125 - 13.181641578674316 + 15.258938789367676 + 15.277900695800781 + 121.26437377929688 + 124.14041900634766 = 1209.855224609375
2024-10-26 19:18:45,516 - 13.249443054199219 + 15.410465240478516 + 15.462523460388184 + 123.70926666259766 + 125.94224548339844 = 1220.853515625
2024-10-26 19:18:48,667 - 12.948652267456055 + 15.018051147460938 + 15.057962417602539 + 120.63919067382812 + 121.443359375 = 1190.2752685546875
2024-10-26 19:18:51,729 - 12.535015106201172 + 14.504150390625 + 14.539113998413086 + 115.64440155029297 + 116.66464233398438 = 1149.492431640625
2024-10-26 19:18:55,307 - 13.364911079406738 + 15.611262321472168 + 15.64872932434082 + 126.3220443725586 + 128.24819946289062 = 1235.4156494140625
2024-10-26 19:18:58,723 - 12.304473876953125 + 14.458637237548828 + 14.445549964904785 + 116.3145980834961 + 116.28401184082031 = 1136.8641357421875
2024-10-26 19:19:02,210 - 12.487309455871582 + 14.665496826171875 + 14.575287818908691 + 118.14764404296875 + 119.14262390136719 = 1154.0634765625
2024-10-26 19:19:05,580 - 12.217994689941406 + 14.440876007080078 + 14.4657621383667 + 116.29528045654297 + 117.34087371826172 = 1133.6021728515625
2024-10-26 19:19:08,585 - 12.644932746887207 + 14.733850479125977 + 14.822875022888184 + 118.3161849975586 + 120.39066314697266 = 1166.520751953125
2024-10-26 19:19:11,624 - 13.132406234741211 + 15.479473114013672 + 15.64328670501709 + 122.20382690429688 + 122.20491790771484 = 1212.2567138671875
2024-10-26 19:19:14,758 - 12.414369583129883 + 14.612199783325195 + 14.736390113830566 + 117.25959777832031 + 118.46797943115234 = 1149.9320068359375
2024-10-26 19:19:18,158 - 12.468528747558594 + 14.696961402893066 + 14.699256896972656 + 117.41944122314453 + 120.36813354492188 = 1155.17626953125
2024-10-26 19:19:21,344 - 12.927331924438477 + 14.890235900878906 + 15.12120246887207 + 120.06367492675781 + 121.4591064453125 = 1188.0037841796875
2024-10-26 19:19:24,392 - 11.996505737304688 + 14.104001998901367 + 14.251993179321289 + 113.61805725097656 + 115.4570083618164 = 1112.4603271484375
2024-10-26 19:19:26,577 - 8.342917442321777 + 10.394831657409668 + 10.417866706848145 + 82.66316223144531 + 84.48692321777344 = 792.4229125976562
2024-10-26 19:19:26,602 - epoch loss:1602.841924493963
2024-10-26 19:19:26,602 - full_loss min:[8.342917442321777, 11.996505737304688], max:77.18273162841797, mean:17.710831347378818
2024-10-26 19:19:26,602 - ns1_loss min:[10.417866706848145, 14.251993179321289], max:78.30623626708984, mean:19.907772584394976
2024-10-26 19:19:26,602 - ns2_loss min:[10.394831657409668, 14.104001998901367], max:78.33000183105469, mean:19.849088322032582
2024-10-26 19:19:26,602 - ps1_loss min:[82.66316223144531, 113.61805725097656], max:630.7137451171875, mean:159.44247547496448
2024-10-26 19:19:26,602 - ps2_loss min:[84.48692321777344, 115.4570083618164], max:630.2587890625, mean:160.28926835493607
2024-10-26 19:19:26,602 - test
2024-10-26 19:19:26,605 - add_self_loops=True
2024-10-26 19:19:26,611 - net=ab_cosine_loss
2024-10-26 19:19:26,611 - test1...
2024-10-26 19:19:28,935 - k = 10
2024-10-26 19:19:28,960 - Acc@1=612/1000=0.612
2024-10-26 19:19:28,961 - Acc@2=725/1000=0.725
2024-10-26 19:19:28,961 - Acc@3=767/1000=0.767
2024-10-26 19:19:28,962 - Acc@4=804/1000=0.804
2024-10-26 19:19:28,963 - Acc@5=825/1000=0.825
2024-10-26 19:19:28,963 - Acc@6=838/1000=0.838
2024-10-26 19:19:28,964 - Acc@7=847/1000=0.847
2024-10-26 19:19:28,964 - Acc@8=857/1000=0.857
2024-10-26 19:19:28,965 - Acc@9=866/1000=0.866
2024-10-26 19:19:28,965 - Acc@10=871/1000=0.871
2024-10-26 19:19:28,966 - test2...
2024-10-26 19:19:33,706 - k = 10
2024-10-26 19:19:33,786 - Acc@1=1500/3000=0.5
2024-10-26 19:19:33,787 - Acc@2=1867/3000=0.622333
2024-10-26 19:19:33,788 - Acc@3=2031/3000=0.677
2024-10-26 19:19:33,788 - Acc@4=2142/3000=0.714
2024-10-26 19:19:33,789 - Acc@5=2216/3000=0.738667
2024-10-26 19:19:33,789 - Acc@6=2271/3000=0.757
2024-10-26 19:19:33,790 - Acc@7=2308/3000=0.769333
2024-10-26 19:19:33,790 - Acc@8=2346/3000=0.782
2024-10-26 19:19:33,791 - Acc@9=2379/3000=0.793
2024-10-26 19:19:33,792 - Acc@10=2402/3000=0.800667
