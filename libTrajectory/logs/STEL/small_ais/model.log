2024-10-09 21:59:11,907 - name: STEL_ais
2024-10-09 21:59:11,907 - config: {'path': './libTrajectory/dataset/small_ais/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}, 'space_distance': 120000, 'time_interval': 21600, 'graph_dim': {'dim1': 8, 'dim2': 10, 'dim3': 2, 'dim4': 4, 'dim5': 10}}, 'executor': {'in_dim': 34, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'model', 'num_workers': 14, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-09 21:59:11,907 - self.path=./libTrajectory/dataset/small_ais/
2024-10-09 21:59:11,907 - loading train tid...
2024-10-09 21:59:11,909 - loading test tid...
2024-10-09 21:59:12,514 - loading enhance sample...
2024-10-09 21:59:21,346 - data load completed
2024-10-09 21:59:21,346 - Executor...
2024-10-09 21:59:21,346 - device=cuda:0, in_dim=34, out_dim=32
2024-10-09 21:59:21,346 - train...
2024-10-09 21:59:21,347 - add_self_loops=True
2024-10-09 21:59:22,206 - lr=0.001, head=4
2024-10-09 21:59:22,207 - full_loss: dis_loss penalty = 0.1
2024-10-09 21:59:22,207 - Epoch 0/1
2024-10-09 22:00:14,798 - 0.6690214276313782 + 0.7334914207458496 + 0.7031601667404175 + 6.187802314758301 + 5.396899223327637 = 59.40229034423828
2024-10-09 22:00:17,275 - 0.3121693730354309 + 0.4386996626853943 + 0.418324738740921 + 3.7987687587738037 + 3.178656816482544 = 31.15614128112793
2024-10-09 22:00:19,475 - 0.24033448100090027 + 0.33328765630722046 + 0.35862642526626587 + 2.9229543209075928 + 2.448380470275879 = 24.30719757080078
2024-10-09 22:00:21,683 - 0.28985023498535156 + 0.387356162071228 + 0.4131584167480469 + 3.2781519889831543 + 2.49497652053833 = 28.27078628540039
2024-10-09 22:00:23,775 - 0.13763628900051117 + 0.24144664406776428 + 0.26333940029144287 + 2.151989221572876 + 1.7187886238098145 = 15.800453186035156
2024-10-09 22:00:26,177 - 0.1542091816663742 + 0.25816065073013306 + 0.2758747935295105 + 2.332139492034912 + 2.037520170211792 = 17.420473098754883
2024-10-09 22:00:28,976 - 0.1439291536808014 + 0.26926133036613464 + 0.26118603348731995 + 2.3812553882598877 + 1.919344186782837 = 16.801530838012695
2024-10-09 22:00:32,084 - 0.12027247995138168 + 0.23072561621665955 + 0.23111644387245178 + 2.195049524307251 + 1.6867432594299316 = 14.513837814331055
2024-10-09 22:00:34,910 - 0.1375136375427246 + 0.2664828598499298 + 0.2697224020957947 + 2.498384952545166 + 1.9840768575668335 = 16.720195770263672
2024-10-09 22:00:37,476 - 0.13263392448425293 + 0.2190214991569519 + 0.24483874440193176 + 2.0368847846984863 + 1.6356420516967773 = 14.942824363708496
2024-10-09 22:00:40,175 - 0.15493258833885193 + 0.23216062784194946 + 0.24167528748512268 + 2.2094621658325195 + 1.782700538635254 = 16.477149963378906
2024-10-09 22:00:42,877 - 0.13238897919654846 + 0.22806745767593384 + 0.2432495355606079 + 2.0796868801116943 + 1.6057360172271729 = 15.018041610717773
2024-10-09 22:00:45,675 - 0.10860706865787506 + 0.21534878015518188 + 0.22115440666675568 + 2.0311167240142822 + 1.650294303894043 = 13.47679615020752
2024-10-09 22:00:48,380 - 0.08646214008331299 + 0.18120458722114563 + 0.19378229975700378 + 1.8446946144104004 + 1.2939757108688354 = 11.211647033691406
2024-10-09 22:00:57,775 - 0.1118866354227066 + 0.21507517993450165 + 0.20710426568984985 + 2.0340895652770996 + 1.6160110235214233 = 13.466226577758789
2024-10-09 22:01:00,100 - 0.10837069153785706 + 0.22065262496471405 + 0.2147119641304016 + 2.093604803085327 + 1.7192339897155762 = 13.585020065307617
2024-10-09 22:01:02,575 - 0.07571158558130264 + 0.18217849731445312 + 0.17928722500801086 + 1.8626818656921387 + 1.5599956512451172 = 10.822914123535156
2024-10-09 22:01:04,603 - 0.06508958339691162 + 0.14252889156341553 + 0.16283944249153137 + 1.3446403741836548 + 1.3383808135986328 = 8.99118423461914
2024-10-09 22:01:07,075 - 0.09354574978351593 + 0.18262368440628052 + 0.179515540599823 + 1.8286292552947998 + 1.4769015312194824 = 11.604209899902344
2024-10-09 22:01:09,675 - 0.11478320509195328 + 0.21060021221637726 + 0.22197690606117249 + 1.8464947938919067 + 1.3736727237701416 = 13.285099029541016
2024-10-09 22:01:11,983 - 0.06213003769516945 + 0.16806082427501678 + 0.15777069330215454 + 1.6192972660064697 + 1.4379544258117676 = 9.422069549560547
2024-10-09 22:01:14,406 - 0.08072491735219955 + 0.15060684084892273 + 0.15741530060768127 + 1.4738900661468506 + 1.4081600904464722 = 9.998517990112305
2024-10-09 22:01:16,675 - 0.07583686709403992 + 0.15219208598136902 + 0.17224009335041046 + 1.511958122253418 + 1.3410093784332275 = 9.889132499694824
2024-10-09 22:01:19,689 - 0.10625636577606201 + 0.1994246244430542 + 0.1965028941631317 + 1.854665756225586 + 1.4386012554168701 = 12.565361022949219
2024-10-09 22:01:21,975 - 0.07273717224597931 + 0.1502988040447235 + 0.15700331330299377 + 1.5917627811431885 + 1.3423855304718018 = 9.644027709960938
2024-10-09 22:01:24,775 - 0.08721939474344254 + 0.17878912389278412 + 0.17939671874046326 + 1.768202304840088 + 1.454923152923584 = 11.16595458984375
2024-10-09 22:01:27,875 - 0.09032900631427765 + 0.17206743359565735 + 0.19330646097660065 + 1.6761722564697266 + 1.3678345680236816 = 11.214195251464844
2024-10-09 22:01:30,975 - 0.10216314345598221 + 0.19481709599494934 + 0.20381855964660645 + 1.836585283279419 + 1.4218416213989258 = 12.35293960571289
2024-10-09 22:01:39,175 - 0.07343998551368713 + 0.14674648642539978 + 0.16934894025325775 + 1.499174952507019 + 1.2470507621765137 = 9.579179763793945
2024-10-09 22:01:41,275 - 0.0771399438381195 + 0.15478932857513428 + 0.16152900457382202 + 1.5562095642089844 + 1.4640077352523804 = 10.040397644042969
2024-10-09 22:01:43,475 - 0.0762067511677742 + 0.16604366898536682 + 0.15316170454025269 + 1.4628329277038574 + 1.2461493015289307 = 9.711373329162598
2024-10-09 22:01:45,413 - 0.06307589262723923 + 0.15462882816791534 + 0.15771685540676117 + 1.5477429628372192 + 1.3466129302978516 = 9.17160701751709
2024-10-09 22:01:47,575 - 0.061266038566827774 + 0.14122401177883148 + 0.1303490400314331 + 1.411158800125122 + 1.1649346351623535 = 8.355125427246094
2024-10-09 22:01:49,275 - 0.08184169977903366 + 0.15474066138267517 + 0.16745874285697937 + 1.492716908454895 + 1.2453311681747437 = 10.05212688446045
2024-10-09 22:01:51,011 - 0.04795704036951065 + 0.12530405819416046 + 0.12351742386817932 + 1.341813564300537 + 1.1526505947113037 = 7.38053035736084
2024-10-09 22:01:53,106 - 0.06190212070941925 + 0.12586522102355957 + 0.13122224807739258 + 1.3127009868621826 + 1.0144675970077515 = 7.993149280548096
2024-10-09 22:01:54,904 - 0.0640651136636734 + 0.13422295451164246 + 0.141606405377388 + 1.344235897064209 + 1.0563671588897705 = 8.362153053283691
2024-10-09 22:01:56,712 - 0.045680709183216095 + 0.12270410358905792 + 0.1275765597820282 + 1.2399498224258423 + 0.9556946754455566 = 6.982486724853516
2024-10-09 22:01:59,414 - 0.08339019119739532 + 0.1474088877439499 + 0.15292546153068542 + 1.3351144790649414 + 1.0643478631973267 = 9.57231616973877
2024-10-09 22:02:01,575 - 0.08063358068466187 + 0.1598123013973236 + 0.15368027985095978 + 1.478868007659912 + 1.1214126348495483 = 9.766885757446289
2024-10-09 22:02:03,075 - 0.060421817004680634 + 0.1325518786907196 + 0.1354338824748993 + 1.2429461479187012 + 1.1100571155548096 = 8.05395221710205
2024-10-09 22:02:05,064 - 0.047686804085969925 + 0.10619519650936127 + 0.11954674124717712 + 1.2231519222259521 + 1.1517715454101562 = 7.016683578491211
2024-10-09 22:02:10,100 - 0.0509340763092041 + 0.12262065708637238 + 0.11721645295619965 + 1.1319597959518433 + 1.020150899887085 = 7.097186088562012
2024-10-09 22:02:11,561 - 0.06568941473960876 + 0.1442318856716156 + 0.14411330223083496 + 1.3381298780441284 + 1.186979055404663 = 8.693031311035156
2024-10-09 22:02:13,829 - 0.06297268718481064 + 0.128921240568161 + 0.13087284564971924 + 1.213889241218567 + 1.0835707187652588 = 8.044034957885742
2024-10-09 22:02:15,234 - 0.05684499070048332 + 0.12615883350372314 + 0.11882254481315613 + 1.1596426963806152 + 1.042365312576294 = 7.494071960449219
2024-10-09 22:02:16,316 - 0.07265110313892365 + 0.13293790817260742 + 0.13158728182315826 + 1.2853347063064575 + 0.9552605152130127 = 8.518402099609375
2024-10-09 22:02:17,706 - 0.06254585087299347 + 0.13091519474983215 + 0.13663801550865173 + 1.1917343139648438 + 1.0573785305023193 = 8.051937103271484
2024-10-09 22:02:19,317 - 0.0669299066066742 + 0.13633579015731812 + 0.1375938504934311 + 1.2652145624160767 + 1.0823005437850952 = 8.433306694030762
2024-10-09 22:02:20,616 - 0.05433426797389984 + 0.12410667538642883 + 0.12025310099124908 + 1.1860812902450562 + 0.9318204522132874 = 7.278213024139404
2024-10-09 22:02:22,565 - 0.03054889664053917 + 0.10130776464939117 + 0.11139272898435593 + 1.1349620819091797 + 1.0065183639526367 = 5.7959303855896
2024-10-09 22:02:24,033 - 0.052194301038980484 + 0.10449866950511932 + 0.11847595870494843 + 1.0716893672943115 + 1.0159156322479248 = 6.927066802978516
2024-10-09 22:02:25,651 - 0.053618110716342926 + 0.12084401398897171 + 0.12348999828100204 + 1.1959925889968872 + 1.0045138597488403 = 7.324751853942871
2024-10-09 22:02:27,108 - 0.05596481263637543 + 0.13197551667690277 + 0.13387514650821686 + 1.2845207452774048 + 1.0298352241516113 = 7.7711029052734375
2024-10-09 22:02:27,793 - 0.03796367719769478 + 0.11083313822746277 + 0.1030333936214447 + 1.1693291664123535 + 0.957838237285614 = 6.164016246795654
2024-10-09 22:02:27,805 - epoch loss:12.239222474531694
2024-10-09 22:02:27,805 - full_loss min:[0.03054889664053917, 0.03796367719769478], max:0.6690214276313782, mean:0.10390263816172426
2024-10-09 22:02:27,805 - ns1_loss min:[0.1030333936214447, 0.11139272898435593], max:0.7031601667404175, mean:0.19226429787549107
2024-10-09 22:02:27,805 - ns2_loss min:[0.10130776464939117, 0.10449866950511932], max:0.7334914207458496, mean:0.18804646825248544
2024-10-09 22:02:27,805 - ps1_loss min:[1.0716893672943115, 1.1319597959518433], max:6.187802314758301, mean:1.7710566000504928
2024-10-09 22:02:27,805 - ps2_loss min:[0.9318204522132874, 0.9552605152130127], max:5.396899223327637, mean:1.469926246729764
2024-10-09 22:02:27,805 - test
2024-10-09 22:02:27,807 - add_self_loops=True
2024-10-09 22:02:27,812 - net=model
2024-10-09 22:02:27,812 - test1...
2024-10-09 22:02:29,781 - k = 10
2024-10-09 22:02:29,799 - top1 = 713 / 1000 = 0.713
2024-10-09 22:02:29,800 - top2 = 817 / 1000 = 0.817
2024-10-09 22:02:29,801 - top3 = 858 / 1000 = 0.858
2024-10-09 22:02:29,801 - top4 = 882 / 1000 = 0.882
2024-10-09 22:02:29,802 - top5 = 890 / 1000 = 0.89
2024-10-09 22:02:29,802 - top6 = 899 / 1000 = 0.899
2024-10-09 22:02:29,803 - top7 = 911 / 1000 = 0.911
2024-10-09 22:02:29,803 - top8 = 919 / 1000 = 0.919
2024-10-09 22:02:29,803 - top9 = 920 / 1000 = 0.92
2024-10-09 22:02:29,804 - top10 = 925 / 1000 = 0.925
2024-10-09 22:02:29,805 - test2...
2024-10-09 22:02:34,051 - k = 10
2024-10-09 22:02:34,121 - top1 = 1755 / 3000 = 0.585
2024-10-09 22:02:34,121 - top2 = 2086 / 3000 = 0.695333
2024-10-09 22:02:34,122 - top3 = 2250 / 3000 = 0.75
2024-10-09 22:02:34,123 - top4 = 2362 / 3000 = 0.787333
2024-10-09 22:02:34,123 - top5 = 2418 / 3000 = 0.806
2024-10-09 22:02:34,124 - top6 = 2480 / 3000 = 0.826667
2024-10-09 22:02:34,124 - top7 = 2517 / 3000 = 0.839
2024-10-09 22:02:34,125 - top8 = 2543 / 3000 = 0.847667
2024-10-09 22:02:34,125 - top9 = 2575 / 3000 = 0.858333
2024-10-09 22:02:34,126 - top10 = 2591 / 3000 = 0.863667
