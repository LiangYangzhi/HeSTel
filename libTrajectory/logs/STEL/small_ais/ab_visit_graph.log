2024-10-26 15:32:54,267 - name: STEL_ais_ab_visit_graph
2024-10-26 15:32:54,268 - config: {'path': './libTrajectory/dataset/small_ais/', 'preprocessing': {'train': 'train_tid', 'test': {'test1': 'test1K.csv', 'test2': 'test3K.csv'}}, 'executor': {'in_dim': 34, 'head': 4, 'out_dim': 32, 'cuda': 0, 'net_name': 'ab_visit_graph', 'num_workers': 6, 'epoch_num': 1, 'batch_size': 128, 'ns_num': 16, 'ps_num': 8, 'lr': 0.001, 'penalty': 0.1, 'ratio_full': 50, 'ratio_ns2': 10, 'ratio_ns1': 10, 'ratio_ps1': 1, 'ratio_ps2': 1}}
2024-10-26 15:32:54,268 - self.path=./libTrajectory/dataset/small_ais/
2024-10-26 15:32:54,268 - loading train tid...
2024-10-26 15:32:54,269 - loading test tid...
2024-10-26 15:32:54,896 - loading enhance sample...
2024-10-26 15:33:03,748 - data load completed
2024-10-26 15:33:03,749 - visit_graph
2024-10-26 15:33:03,749 - Executor...
2024-10-26 15:33:03,749 - device=cuda:0, in_dim=34, out_dim=32
2024-10-26 15:33:03,749 - train...
2024-10-26 15:33:03,749 - add_self_loops=True
2024-10-26 15:33:04,552 - lr=0.001, head=4
2024-10-26 15:33:04,553 - full_loss: dis_loss penalty = 0.1
2024-10-26 15:33:04,553 - Epoch 0/1
2024-10-26 15:33:20,896 - 0.891096830368042 + 0.9294284582138062 + 0.8807011842727661 + 7.445186614990234 + 6.989095687866211 = 77.09041595458984
2024-10-26 15:33:22,295 - 0.45755890011787415 + 0.512399435043335 + 0.4797589182853699 + 4.178198337554932 + 3.7613134384155273 = 40.739044189453125
2024-10-26 15:33:23,999 - 0.3589160442352295 + 0.4346407353878021 + 0.4152925908565521 + 3.5167410373687744 + 3.6211345195770264 = 33.583011627197266
2024-10-26 15:33:25,563 - 0.3151284158229828 + 0.4000983238220215 + 0.4117017388343811 + 3.294826030731201 + 3.1290371417999268 = 30.29828643798828
2024-10-26 15:33:27,114 - 0.24868963658809662 + 0.3474504351615906 + 0.3559291958808899 + 2.8177998065948486 + 2.805661678314209 = 25.091739654541016
2024-10-26 15:33:28,450 - 0.26187455654144287 + 0.33490586280822754 + 0.3718488812446594 + 2.763758897781372 + 2.659882068634033 = 25.584917068481445
2024-10-26 15:33:35,046 - 0.1761103868484497 + 0.2893421947956085 + 0.269206702709198 + 2.3799400329589844 + 2.248094081878662 = 19.01904296875
2024-10-26 15:33:36,368 - 0.20315533876419067 + 0.2732412815093994 + 0.27793312072753906 + 2.244534492492676 + 2.0599422454833984 = 19.973989486694336
2024-10-26 15:33:37,596 - 0.18223145604133606 + 0.27447864413261414 + 0.2653067708015442 + 2.2535831928253174 + 2.156832218170166 = 18.919841766357422
2024-10-26 15:33:39,063 - 0.2018926739692688 + 0.28423869609832764 + 0.3012763261795044 + 2.326097011566162 + 2.2711074352264404 = 20.546987533569336
2024-10-26 15:33:40,458 - 0.15974372625350952 + 0.2512287199497223 + 0.2732431888580322 + 2.116056442260742 + 1.8414034843444824 = 17.18936538696289
2024-10-26 15:33:41,734 - 0.14520594477653503 + 0.23517271876335144 + 0.24014165997505188 + 1.924698829650879 + 1.864363193511963 = 15.80250358581543
2024-10-26 15:33:49,516 - 0.22483763098716736 + 0.31929144263267517 + 0.3137107789516449 + 2.6318938732147217 + 2.3169569969177246 = 22.520753860473633
2024-10-26 15:33:51,356 - 0.16106265783309937 + 0.2298237383365631 + 0.23648568987846375 + 1.9100489616394043 + 1.6653573513031006 = 16.29163360595703
2024-10-26 15:33:52,582 - 0.14548920094966888 + 0.22296865284442902 + 0.22614994645118713 + 1.827674388885498 + 1.6992714405059814 = 15.29259204864502
2024-10-26 15:33:54,044 - 0.14364197850227356 + 0.24951152503490448 + 0.25044795870780945 + 2.0380136966705322 + 1.9340107440948486 = 16.153717041015625
2024-10-26 15:33:55,588 - 0.153727188706398 + 0.25090137124061584 + 0.24217671155929565 + 2.0506350994110107 + 1.8701530694961548 = 16.53792953491211
2024-10-26 15:33:57,161 - 0.13333992660045624 + 0.20381960272789001 + 0.21994122862815857 + 1.66953706741333 + 1.8165647983551025 = 14.390707015991211
2024-10-26 15:34:03,873 - 0.0904652327299118 + 0.20651356875896454 + 0.20236152410507202 + 1.7046375274658203 + 1.7547047138214111 = 12.071354866027832
2024-10-26 15:34:05,566 - 0.16955319046974182 + 0.2540770173072815 + 0.2530367970466614 + 2.086942195892334 + 2.085679054260254 = 17.721416473388672
2024-10-26 15:34:06,799 - 0.12066513299942017 + 0.2013188898563385 + 0.20248961448669434 + 1.6676208972930908 + 1.7017533779144287 = 13.440716743469238
2024-10-26 15:34:08,114 - 0.11373277008533478 + 0.20629993081092834 + 0.2033485770225525 + 1.6971886157989502 + 1.6376605033874512 = 13.117971420288086
2024-10-26 15:34:09,563 - 0.13073770701885223 + 0.22133272886276245 + 0.21873973309993744 + 1.8275808095932007 + 1.6524710655212402 = 14.417661666870117
2024-10-26 15:34:10,955 - 0.09832800924777985 + 0.20033913850784302 + 0.2044951617717743 + 1.6679762601852417 + 1.5774096250534058 = 12.210129737854004
2024-10-26 15:34:17,060 - 0.12063273787498474 + 0.19217070937156677 + 0.19578024744987488 + 1.5962547063827515 + 1.6080079078674316 = 13.115407943725586
2024-10-26 15:34:18,476 - 0.12671080231666565 + 0.21062731742858887 + 0.22298215329647064 + 1.7524149417877197 + 1.7016857862472534 = 14.12573528289795
2024-10-26 15:34:20,114 - 0.10081958770751953 + 0.20255187153816223 + 0.19153743982315063 + 1.6899365186691284 + 1.5817612409591675 = 12.253570556640625
2024-10-26 15:34:21,358 - 0.0925283432006836 + 0.17145074903964996 + 0.17926877737045288 + 1.4325132369995117 + 1.34779953956604 = 10.913925170898438
2024-10-26 15:34:22,854 - 0.1212235540151596 + 0.19210185110569 + 0.20470038056373596 + 1.6029692888259888 + 1.5483266115188599 = 13.180495262145996
2024-10-26 15:34:24,181 - 0.11896104365587234 + 0.194521963596344 + 0.17484524846076965 + 1.5981498956680298 + 1.6332974433898926 = 12.873172760009766
2024-10-26 15:34:29,215 - 0.09888216853141785 + 0.18242749571800232 + 0.1860775649547577 + 1.507712483406067 + 1.4849042892456055 = 11.62177562713623
2024-10-26 15:34:30,671 - 0.09479527175426483 + 0.17067945003509521 + 0.1690097451210022 + 1.4295490980148315 + 1.3963778018951416 = 10.9625825881958
2024-10-26 15:34:32,231 - 0.08926602452993393 + 0.16686630249023438 + 0.16171333193778992 + 1.380866527557373 + 1.450678825378418 = 10.580643653869629
2024-10-26 15:34:33,957 - 0.07964017242193222 + 0.15942871570587158 + 0.1614365577697754 + 1.338668704032898 + 1.3679509162902832 = 9.897281646728516
2024-10-26 15:34:35,180 - 0.08142928779125214 + 0.1565973460674286 + 0.1580979973077774 + 1.3005914688110352 + 1.2300955057144165 = 9.749104499816895
2024-10-26 15:34:36,915 - 0.0794985443353653 + 0.15012726187705994 + 0.15756145119667053 + 1.2369991540908813 + 1.2773451805114746 = 9.566158294677734
2024-10-26 15:34:42,719 - 0.0896044597029686 + 0.15258744359016418 + 0.14920851588249207 + 1.2537922859191895 + 1.2678173780441284 = 10.019793510437012
2024-10-26 15:34:44,163 - 0.0893191546201706 + 0.15531283617019653 + 0.1705818474292755 + 1.2812793254852295 + 1.3723008632659912 = 10.378484725952148
2024-10-26 15:34:45,382 - 0.08964656293392181 + 0.14795804023742676 + 0.1468031406402588 + 1.2035057544708252 + 1.2903170585632324 = 9.923763275146484
2024-10-26 15:34:51,122 - 0.09037010371685028 + 0.16667486727237701 + 0.16543763875961304 + 1.3755970001220703 + 1.3955415487289429 = 10.61076831817627
2024-10-26 15:34:52,375 - 0.090406134724617 + 0.16341149806976318 + 0.158085897564888 + 1.3451696634292603 + 1.2627671957015991 = 10.343217849731445
2024-10-26 15:34:54,017 - 0.08002591133117676 + 0.16045063734054565 + 0.16488175094127655 + 1.338763952255249 + 1.3167030811309814 = 9.910086631774902
2024-10-26 15:34:55,841 - 0.0990983098745346 + 0.16906625032424927 + 0.171461820602417 + 1.3988068103790283 + 1.3398606777191162 = 11.09886360168457
2024-10-26 15:34:57,642 - 0.07420895993709564 + 0.14035682380199432 + 0.15170030295848846 + 1.173792839050293 + 1.135307788848877 = 8.940120697021484
2024-10-26 15:34:58,877 - 0.09893812239170074 + 0.17277513444423676 + 0.1740700900554657 + 1.4221850633621216 + 1.298498272895813 = 11.136041641235352
2024-10-26 15:35:01,053 - 0.07396191358566284 + 0.1330181360244751 + 0.14530262351036072 + 1.1155502796173096 + 1.0390888452529907 = 8.635943412780762
2024-10-26 15:35:02,416 - 0.07618590444326401 + 0.14018552005290985 + 0.14308661222457886 + 1.1540210247039795 + 1.1064631938934326 = 8.902501106262207
2024-10-26 15:35:04,142 - 0.0903780460357666 + 0.14939242601394653 + 0.15716241300106049 + 1.2351419925689697 + 1.1168893575668335 = 9.936481475830078
2024-10-26 15:35:09,168 - 0.09179582446813583 + 0.13945254683494568 + 0.15299677848815918 + 1.1677228212356567 + 1.1158323287963867 = 9.797840118408203
2024-10-26 15:35:10,496 - 0.08238033205270767 + 0.1529759168624878 + 0.14559796452522278 + 1.2704994678497314 + 1.2590296268463135 = 9.634284019470215
2024-10-26 15:35:12,000 - 0.086271271109581 + 0.14211229979991913 + 0.14954322576522827 + 1.1797676086425781 + 1.1285475492477417 = 9.538434028625488
2024-10-26 15:35:15,722 - 0.07261218130588531 + 0.12974807620048523 + 0.12800073623657227 + 1.0742062330245972 + 1.0644159317016602 = 8.346719741821289
2024-10-26 15:35:17,127 - 0.0629994198679924 + 0.1325032114982605 + 0.13355879485607147 + 1.1210304498672485 + 1.0943061113357544 = 8.025927543640137
2024-10-26 15:35:18,368 - 0.0811995267868042 + 0.13625667989253998 + 0.13931059837341309 + 1.1469430923461914 + 1.1116626262664795 = 9.074254989624023
2024-10-26 15:35:18,996 - 0.056191544979810715 + 0.11831538379192352 + 0.11870954930782318 + 0.9866279363632202 + 0.9611271619796753 = 7.12758207321167
2024-10-26 15:35:19,005 - epoch loss:15.422303485870362
2024-10-26 15:35:19,005 - full_loss min:[0.056191544979810715, 0.0629994198679924], max:0.891096830368042, mean:0.14667574106292292
2024-10-26 15:35:19,006 - ns1_loss min:[0.11870954930782318, 0.12800073623657227], max:0.8807011842727661, mean:0.22444063994017513
2024-10-26 15:35:19,006 - ns2_loss min:[0.11831538379192352, 0.12974807620048523], max:0.9294284582138062, mean:0.22336232499642805
2024-10-26 15:35:19,006 - ps1_loss min:[0.9866279363632202, 1.0742062330245972], max:7.445186614990234, mean:1.839130904457786
2024-10-26 15:35:19,006 - ps2_loss min:[0.9611271619796753, 1.0390888452529907], max:6.989095687866211, mean:1.7713557741858743
2024-10-26 15:35:19,006 - test
2024-10-26 15:35:19,008 - add_self_loops=True
2024-10-26 15:35:19,014 - net=ab_visit_graph
2024-10-26 15:35:19,015 - test1...
2024-10-26 15:35:21,487 - k = 10
2024-10-26 15:35:21,509 - Acc@1=575/1000=0.575
2024-10-26 15:35:21,509 - Acc@2=691/1000=0.691
2024-10-26 15:35:21,510 - Acc@3=752/1000=0.752
2024-10-26 15:35:21,510 - Acc@4=793/1000=0.793
2024-10-26 15:35:21,511 - Acc@5=815/1000=0.815
2024-10-26 15:35:21,512 - Acc@6=842/1000=0.842
2024-10-26 15:35:21,512 - Acc@7=861/1000=0.861
2024-10-26 15:35:21,513 - Acc@8=872/1000=0.872
2024-10-26 15:35:21,513 - Acc@9=887/1000=0.887
2024-10-26 15:35:21,514 - Acc@10=897/1000=0.897
2024-10-26 15:35:21,514 - test2...
2024-10-26 15:35:27,485 - k = 10
2024-10-26 15:35:27,563 - Acc@1=1253/3000=0.417667
2024-10-26 15:35:27,564 - Acc@2=1643/3000=0.547667
2024-10-26 15:35:27,564 - Acc@3=1860/3000=0.62
2024-10-26 15:35:27,565 - Acc@4=2001/3000=0.667
2024-10-26 15:35:27,565 - Acc@5=2089/3000=0.696333
2024-10-26 15:35:27,566 - Acc@6=2160/3000=0.72
2024-10-26 15:35:27,566 - Acc@7=2239/3000=0.746333
2024-10-26 15:35:27,567 - Acc@8=2282/3000=0.760667
2024-10-26 15:35:27,567 - Acc@9=2321/3000=0.773667
2024-10-26 15:35:27,568 - Acc@10=2360/3000=0.786667
